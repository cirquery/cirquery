# dsl.md
## version: 0.2

## å…¨ä½“æ§‹æˆï¼ˆç« ç«‹ã¦ï¼‰
1. ç›®çš„ãƒ»é©ç”¨ç¯„å›²
2. ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆä¾‹ã¨æœŸå¾…çµæœï¼‰
3. æ–‡æ³•æ¦‚è¦ï¼ˆå„ªå…ˆé †ä½ãƒ»ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ§‹é€ ï¼‰
4. ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ï¼ˆè­˜åˆ¥å­ãƒ»ã‚¯ã‚ªãƒ¼ãƒˆãƒ»äºˆç´„èªï¼‰
5. ãƒªãƒ†ãƒ©ãƒ«ï¼ˆæ–‡å­—åˆ—/æ•°å€¤/ãƒ–ãƒ¼ãƒ«/nullã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
6. æ¯”è¼ƒæ¼”ç®—ï¼ˆ=, !=, >, >=, <, <=ï¼‰
7. ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ï¼ˆcontains/startsWith/endsWith ã¨çœç•¥å½¢ path:valueï¼‰
8. é…åˆ—ä½œç”¨ï¼ˆany/all/noneã€ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã¨åŒä¸€è¦ç´ ANDï¼‰
9. è¤‡åˆå€¤ãƒ»è¤‡åˆæ¡ä»¶ï¼ˆpath:(...), æ–‡å­—åˆ—ã®ORã€æ¯”è¼ƒã®ANDï¼‰
10. è«–ç†æ¼”ç®—ï¼ˆAND/OR/NOTã€æ‹¬å¼§ã€å„ªå…ˆé †ä½ï¼‰
11. æ­£è¦åŒ–è¦å‰‡ï¼ˆASTã‹ã‚‰CIRã¸ï¼‰
12. ã‚¨ãƒ©ãƒ¼ä»•æ§˜ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–¹é‡ãƒ»ä»£è¡¨ã‚±ãƒ¼ã‚¹ï¼‰
13. ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨å°†æ¥æ‹¡å¼µï¼ˆignoreCase ã»ã‹ï¼‰
14. äº’æ›ãƒ»éç›®æ¨™ï¼ˆæœ¬DSLãŒã‚«ãƒãƒ¼ã—ãªã„ã‚‚ã®ï¼‰
15. å‚è€ƒã®å†™åƒä¾‹ï¼ˆDSLã‹ã‚‰CIRã¸ã®å¤‰æ›ã‚¹ã‚±ãƒƒãƒï¼‰


***


## **ç¬¬1ç« ã€€ç›®çš„ãƒ»é©ç”¨ç¯„å›²**

### 1.1 ç›®çš„
æœ¬DSLï¼ˆDomain Specific Languageï¼‰ã¯ã€ãƒã‚¹ãƒˆæ§‹é€ ã‚„é…åˆ—ã‚’å«ã‚€JSONãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã€è‡ªç„¶ã§ç°¡æ½”ãªæ§‹æ–‡ã§æŸ”è»Ÿãªæ¤œç´¢æ¡ä»¶ã‚’è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªè¨€èªã§ã™ã€‚  
**ä¾‹ï¼š**
```
ingredients.name:"ã‚¸ãƒ³" AND alcohol_content:>20
```
ã“ã®ã‚ˆã†ãª1è¡Œã®ã‚¯ã‚¨ãƒªã‚’ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«éä¾å­˜ãªä¸­é–“è¡¨ç¾ï¼ˆCIR: Canonical Intermediate Representationï¼‰ã«å¤‰æ›ã—ã€æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ¤œç´¢ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### 1.2 èƒŒæ™¯
- å¾“æ¥ã®JSONæ¤œç´¢æ‰‹æ®µï¼ˆä¾‹: MongoDBã‚¯ã‚¨ãƒªã€Elasticsearch DSLã€JMESPath ç­‰ï¼‰ã¯å¼·åŠ›ã§ã™ãŒã€ãã‚Œãã‚Œæ§‹æ–‡ã‚„è¡¨ç¾ãŒç•°ãªã‚Šå­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„ã¨ã„ã†èª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚
- Googleæ¤œç´¢ã®ã‚ˆã†ã«ã€**äººãŒç›´æ„Ÿçš„ã«æ›¸ã‘ã‚‹çŸ­ã„æ–‡å­—åˆ—ã‹ã‚‰é«˜æ©Ÿèƒ½ãªæ¤œç´¢æ¡ä»¶ã¸**ã¨å¤‰æ›ã—ãŸã„ã¨ã„ã†éœ€è¦ãŒã‚ã‚Šã¾ã™ã€‚
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«éä¾å­˜ãªå½¢ã§ãƒ‘ãƒ¼ã‚¹ã—ã€JavaScriptã®è¿°èªé–¢æ•°ã‚„MongoDBã‚¯ã‚¨ãƒªç­‰ã®è¤‡æ•°ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«å¤‰æ›ã§ãã‚‹OSSã¯éå¸¸ã«å°‘ãªã„ã®ãŒç¾çŠ¶ã§ã™ã€‚

### 1.3 è¨­è¨ˆåŸå‰‡
æœ¬DSLã¯ã€é–‹ç™ºè€…ãŒå®¹æ˜“ã«åˆ©ç”¨ãƒ»æ‹¡å¼µã§ãã‚‹ã‚ˆã†ã€ä»¥ä¸‹ã®è¨­è¨ˆåŸå‰‡ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚
- **ç°¡æ½”ã•ã®å„ªå…ˆ**: Googleæ¤œç´¢ã®ã‚ˆã†ãª `key:value` å½¢å¼ã‚’åŸºæœ¬ã¨ã—ã€ä¸€èˆ¬çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’ç°¡æ½”ã«è¨˜è¿°ã§ãã‚‹ã“ã¨ã‚’æœ€å„ªå…ˆã—ã¾ã™ã€‚
- **è¡¨ç¾åŠ›ã¨ã®ä¸¡ç«‹**: è¤‡é›‘ãªæ¡ä»¶ã¯ã€çœç•¥å½¢ã§ã¯ãªãæ˜ç¤ºçš„ãªé–¢æ•°å½¢å¼ã‚„æ‹¬å¼§ã§è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«ã—ã€å¯èª­æ€§ã¨è¡¨ç¾åŠ›ã‚’ä¸¡ç«‹ã•ã›ã¾ã™ã€‚
- **ç›´æ„Ÿçš„ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: é…åˆ—ã®æ“ä½œã¯ã€æœ€ã‚‚åˆ©ç”¨é »åº¦ã®é«˜ã„ `any`ï¼ˆã„ãšã‚Œã‹ã®è¦ç´ ãŒåˆè‡´ï¼‰ã‚’æš—é»™ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åˆ©ç”¨è€…ã¯é…åˆ—ã‚’æ„è­˜ã›ãšè‡ªç„¶ã«ã‚¯ã‚¨ãƒªã‚’è¨˜è¿°ã§ãã¾ã™ã€‚

### 1.4 é©ç”¨ç¯„å›²ï¼ˆv0.1ä»•æ§˜ï¼‰
æœ¬ä»•æ§˜ v0.1 ã§ã¯ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
- **è«–ç†æ¼”ç®—**: `AND` / `OR` / `NOT` ã¨æ‹¬å¼§ã«ã‚ˆã‚‹ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
- **æ¯”è¼ƒæ¼”ç®—**: `=`, `!=`, `>`, `>=`, `<`, `<=`
- **ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—**: `contains`, `startsWith`, `endsWith` ã¨ãã®çœç•¥å½¢
- **é…åˆ—ä½œç”¨**: `any`, `all`, `none` ã¨ãã®çœç•¥å½¢
- **ãƒªãƒ†ãƒ©ãƒ«**: æ–‡å­—åˆ—ãƒ»æ•°å€¤ãƒ»çœŸå½å€¤ãƒ»null

### 1.5 éå¯¾è±¡ï¼ˆç¾æ™‚ç‚¹ã§ã®ç¯„å›²å¤–ï¼‰
- æ­£è¦è¡¨ç¾æ¤œç´¢ï¼ˆå°†æ¥æ‹¡å¼µäºˆå®šï¼‰
- `in` / `not in` å°‚ç”¨æ¼”ç®—å­ï¼ˆv0.2ä»¥é™ã§æ¤œè¨ï¼‰
- æ—¥ä»˜å‹å°‚ç”¨ã®æ¯”è¼ƒã‚„ãƒ­ã‚±ãƒ¼ãƒ«ä¾å­˜ã®æ–‡å­—åˆ—æ¯”è¼ƒ
- é«˜åº¦ãªå…¨æ–‡æ¤œç´¢ï¼ˆfuzzy search, scoringç­‰ï¼‰

### 1.6 ç”¨èªã®å®šç¾©
æœ¬ä»•æ§˜æ›¸ã§ç”¨ã„ã‚‹ä¸»è¦ãªç”¨èªã‚’ä»¥ä¸‹ã«å®šç¾©ã—ã¾ã™ã€‚
- **DSL (Domain Specific Language)**: æœ¬ä»•æ§˜æ›¸ã§å®šç¾©ã•ã‚Œã‚‹ã€JSONæ¤œç´¢ã«ç‰¹åŒ–ã—ãŸã‚¯ã‚¨ãƒªè¨€èªã€‚
- **AST (Abstract Syntax Tree)**: å…¥åŠ›ã•ã‚ŒãŸDSLã‚¯ã‚¨ãƒªã®æ§‹æ–‡æ§‹é€ ã‚’å¿ å®Ÿã«è¡¨ç¾ã—ãŸãƒ„ãƒªãƒ¼æ§‹é€ ã®ä¸­é–“è¡¨ç¾ã€‚
- **CIR (Canonical Intermediate Representation)**: ASTã‚’æ­£è¦åŒ–ã—ãŸã€è©•ä¾¡ã‚„å„ç¨®ã‚¢ãƒ€ãƒ—ã‚¿ã¸ã®å¤‰æ›ã«é©ã—ãŸä¸­é–“è¡¨ç¾ã€‚çœç•¥å½¢ã¯å±•é–‹ã•ã‚Œã€å¦å®šï¼ˆNOTï¼‰ã¯å¯èƒ½ãªé™ã‚Šæœ«ç«¯ã®æ¡ä»¶ã«æŠ¼ã—ä¸‹ã’ã‚‰ã‚Œã¾ã™ã€‚
- **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ (Field Path)**: JSONãƒ‡ãƒ¼ã‚¿å†…ã®ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒ‡ã—ç¤ºã™ãŸã‚ã®ãƒ‰ãƒƒãƒˆåŒºåˆ‡ã‚Šã®æ–‡å­—åˆ—ï¼ˆä¾‹: `author.name`ï¼‰ã€‚

***

## **ç¬¬2ç« ã€€ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ**

ã“ã®ç« ã§ã¯ã€è©³ç´°ãªæ–‡æ³•èª¬æ˜ã«å…¥ã‚‹å‰ã«ã€DSLã®ä½¿ã„æ–¹ã‚’çŸ­ã„ä¾‹ã§ç¤ºã—ã€ã©ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚Œã‚‹ã‹ã‚’ç›´æ„Ÿçš„ã«ç†è§£ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### **2.1 å˜ç´”ãªæ¯”è¼ƒ**
**DSL**: `alcohol_content:>20`  
**æ„å‘³**: `alcohol_content` ãŒ 20 ã‚ˆã‚Šå¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
ï¼ˆè©³ç´°ã¯ **ç¬¬6ç« ** ã‚’å‚ç…§ï¼‰

### **2.2 éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ï¼ˆcontainsï¼‰**
**DSL**: `ingredients.name:"ã‚¸ãƒ³"`  
**æ„å‘³**: ææ–™ï¼ˆ`ingredients`é…åˆ—ï¼‰ã®ã„ãšã‚Œã‹ã®è¦ç´ ã§ã€`name` ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã“ã‚Œã¯ `any(ingredients, name contains "ã‚¸ãƒ³")` ã¨ã—ã¦è©•ä¾¡ã•ã‚Œã¾ã™ã€‚  
ï¼ˆè©³ç´°ã¯ **ç¬¬7ç« **, **ç¬¬8ç« ** ã‚’å‚ç…§ï¼‰

### **2.3 è¤‡æ•°æ¡ä»¶ã®çµ„ã¿åˆã‚ã›**
**DSL**: `ingredients.name:"ã‚¸ãƒ³" AND alcohol_content:>20`  
**æ„å‘³**: ææ–™ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã¿ã€ã‹ã¤ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°ãŒ20ã‚’è¶…ãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
ï¼ˆè©³ç´°ã¯ **ç¬¬10ç« ** ã‚’å‚ç…§ï¼‰

### **2.4 ãƒã‚¹ãƒˆã—ãŸORæ¡ä»¶**
**DSL**: `author.name="Bar Curion" AND (ingredients.type:"ãƒªã‚­ãƒ¥ãƒ¼ãƒ«" OR ingredients.type:"ã‚¹ãƒ”ãƒªãƒƒãƒ„")`  
**æ„å‘³**: ä½œè€…ãŒã€ŒBar Curionã€ã§ã‚ã‚Šã€ã‹ã¤ææ–™ã®ç¨®é¡ãŒã€Œãƒªã‚­ãƒ¥ãƒ¼ãƒ«ã€ã¾ãŸã¯ã€Œã‚¹ãƒ”ãƒªãƒƒãƒ„ã€ã§ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

### **2.5 åŒä¸€è¦ç´ å†…ã®AND**
**DSL**: `ingredients:(name:"ã‚¸ãƒ³" AND type:"ã‚¹ãƒ”ãƒªãƒƒãƒ„")`  
**æ„å‘³**: `ingredients` é…åˆ—ã® **åŒã˜è¦ç´ å†…** ã§ã€`name` ãŒã€Œã‚¸ãƒ³ã€ã‹ã¤ `type` ãŒã€Œã‚¹ãƒ”ãƒªãƒƒãƒ„ã€ã§ã‚ã‚‹æ¡ä»¶ã‚’æº€ãŸã™ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
ï¼ˆè©³ç´°ã¯ **ç¬¬8ç« **, **ç¬¬9ç« ** ã‚’å‚ç…§ï¼‰

### **2.6 è¤‡æ•°å€¤ã®ORï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã™ã‚‹è¤‡æ•°èªï¼‰**
**DSL**: `ingredients.name:("ã‚¸ãƒ³","ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`  
**æ„å‘³**: `name` ã«ã€Œã‚¸ãƒ³ã€ã¾ãŸã¯ã€Œã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã€ã‚’å«ã‚€ææ–™ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã“ã‚Œã¯ `any(ingredients, name contains "ã‚¸ãƒ³" OR name contains "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")` ã¨ç­‰ä¾¡ã§ã™ã€‚  
ï¼ˆè©³ç´°ã¯ **ç¬¬9ç« ** ã‚’å‚ç…§ï¼‰

### **2.7 æ•°å€¤ç¯„å›²æ¤œç´¢**
**DSL**: `alcohol_content:(>5,<13)`  
**æ„å‘³**: ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°ãŒ5ã‚ˆã‚Šå¤§ããã€ã‹ã¤13æœªæº€ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚åŒä¸€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã™ã‚‹æ•°å€¤æ¯”è¼ƒã¯ **AND** ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¾ã™ã€‚

### **2.8 NOTæ¡ä»¶**
**DSL**: `NOT ingredients.name:"ã‚¸ãƒ³"`  
**æ„å‘³**: ææ–™ã«ã€Œã‚¸ãƒ³ã€ã‚’ä¸€åˆ‡å«ã¾ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

***

## **ç¬¬3ç« ã€€æ–‡æ³•æ¦‚è¦ï¼ˆå„ªå…ˆé †ä½ãƒ»ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ§‹é€ ï¼‰**

ã“ã®ç« ã§ã¯ã€DSLã®åŸºç¤çš„ãªæ–‡æ³•æ§‹é€ ã¨ã€æ¼”ç®—å­ã®å„ªå…ˆé †ä½ã‚’ç¤ºã—ã¾ã™ã€‚ä»¥é™ã®ç« ã§å„æ§‹æˆè¦ç´ ã®è©³ç´°ã‚’èª¬æ˜ã—ã¾ã™ãŒã€ã“ã“ã§ã¯å…¨ä½“åƒã‚’æŠŠæ¡ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚

### **3.1 ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ§‹é€ **
DSLã‚¯ã‚¨ãƒªã¯ **å¼ï¼ˆExpressionï¼‰** ã‚’1ã¤ä»¥ä¸Šçµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã§ã‚ã‚Šã€è«–ç†æ¼”ç®—å­ `AND` / `OR` / `NOT` ãŠã‚ˆã³æ‹¬å¼§ã‚’ä½¿ã£ã¦æ§‹é€ åŒ–ã—ã¾ã™ã€‚ä»¥ä¸‹ã«ç°¡æ˜“çš„ãªBNFï¼ˆãƒãƒƒã‚«ã‚¹ãƒ»ãƒŠã‚¦ã‚¢è¨˜æ³•ï¼‰ã§æ§‹é€ ã‚’ç¤ºã—ã¾ã™ã€‚

```
<query> ::= <expr>
<expr>  ::= <orExpr>
<orExpr> ::= <andExpr> ( OR <andExpr> )*
<andExpr> ::= <notExpr> ( AND <notExpr> )*
<notExpr> ::= ( NOT <notExpr> ) | <primary>
<primary> ::= <comparison> | <textShorthand> | <quantified> | "(" <expr> ")"
```

### **3.2 æ¼”ç®—å­ã®å„ªå…ˆé †ä½**
æ¼”ç®—å­ã¯ã€ä»¥ä¸‹ã®å„ªå…ˆé †ä½ï¼ˆé«˜ã„é †ï¼‰ã§é©ç”¨ã•ã‚Œã¾ã™ã€‚

1.  **`()`ï¼ˆæ‹¬å¼§ï¼‰**: æœ€ã‚‚å„ªå…ˆé †ä½ãŒé«˜ãã€ä»»æ„ã®å¼ã®è©•ä¾¡é †åºã‚’æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ã¾ã™ã€‚
2.  **`NOT`**: å˜ä¸€ã®æ¡ä»¶ã‚„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å¦å®šã—ã¾ã™ã€‚
3.  **`AND`**: ä¸¡æ–¹ã®æ¡ä»¶ãŒçœŸã§ã‚ã‚‹å ´åˆã«å…¨ä½“ã‚’çœŸã¨ã—ã¾ã™ã€‚
4.  **`OR`**: ã„ãšã‚Œã‹ã®æ¡ä»¶ãŒçœŸã§ã‚ã‚‹å ´åˆã«å…¨ä½“ã‚’çœŸã¨ã—ã¾ã™ã€‚

`A OR B AND C` ã¯ `A OR (B AND C)` ã¨è§£é‡ˆã•ã‚Œã¾ã™ã€‚

### **3.3 ãƒˆãƒ¼ã‚¯ãƒ³ã®åŒºåˆ‡ã‚Šè¦å‰‡**
- **ã‚¹ãƒšãƒ¼ã‚¹/æ”¹è¡Œ**: æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«å†…éƒ¨ã‚’é™¤ãã€ãƒˆãƒ¼ã‚¯ãƒ³ã®åŒºåˆ‡ã‚Šã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚é€£ç¶šã™ã‚‹ã‚¹ãƒšãƒ¼ã‚¹ã¯1ã¤ã®åŒºåˆ‡ã‚Šã¨ã¿ãªã•ã‚Œã¾ã™ã€‚
- **è«–ç†æ¼”ç®—å­**: `AND` / `OR` / `NOT` ã¯å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ã¾ã›ã‚“ï¼ˆä¾‹: `and` ã§ã‚‚å¯ï¼‰ã€‚
- **åŒºåˆ‡ã‚Šæ–‡å­—**: `:` ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã¨å€¤ã®åŒºåˆ‡ã‚Šã«ã€`,` ã¯è¤‡åˆå€¤ãƒªã‚¹ãƒˆã®åŒºåˆ‡ã‚Šã«ä½¿ç”¨ã—ã¾ã™ã€‚

### **3.4 æ–‡æ³•è¦ç´ ã®åˆ†é¡**
- **æ¯”è¼ƒæ¼”ç®—**: `=`, `!=`, `>`, `>=`, `<`, `<=`
- **ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—**: `contains`, `startsWith`, `endsWith`
- **çœç•¥å½¢**: `field:value`ï¼ˆ`contains`ã¨ç­‰ä¾¡ï¼‰
- **é…åˆ—ä½œç”¨**: `any`, `all`, `none`
- **è«–ç†æ¼”ç®—**: `AND`, `OR`, `NOT`

ã“ã®ç« ã§DSLã®åŸºæœ¬æ§‹é€ ã¨æ¼”ç®—å­ã®å„ªå…ˆåº¦ã‚’æ´ã‚€ã“ã¨ã§ã€æ¬¡ç« ä»¥é™ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã‚„ãƒªãƒ†ãƒ©ãƒ«ã®è©³ç´°ãªèª¬æ˜ãŒç†è§£ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

***

## **ç¬¬4ç« ã€€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ï¼ˆè­˜åˆ¥å­ãƒ»ã‚¯ã‚ªãƒ¼ãƒˆãƒ»äºˆç´„èªï¼‰**

ã“ã®ç« ã§ã¯ã€JSONãƒ‡ãƒ¼ã‚¿å†…ã®ç‰¹å®šã®å€¤ã‚’æŒ‡ã—ç¤ºã™ã€Œãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã€ã®ä»•æ§˜ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

### **4.1 ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã®å½¹å‰²**
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã¯ã€æ¤œç´¢å¯¾è±¡ã¨ãªã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®è¡¨è¨˜ã§ã™ã€‚ãƒ‰ãƒƒãƒˆï¼ˆ`.`ï¼‰ã‚’ä½¿ã£ã¦ãƒã‚¹ãƒˆã—ãŸéšå±¤ã‚’è¡¨ç¾ã—ã¾ã™ã€‚
- ä¾‹: `name`ï¼ˆãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã® `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
- ä¾‹: `author.name`ï¼ˆ`author` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã® `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
- ä¾‹: `ingredients.name`ï¼ˆ`ingredients` é…åˆ—ã®å„è¦ç´ ãŒæŒã¤ `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰

### **4.2 åŸºæœ¬æ§‹æ–‡**
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã¯ã€1ã¤ä»¥ä¸Šã®ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€ãŒãƒ‰ãƒƒãƒˆã§é€£çµã•ã‚ŒãŸã‚‚ã®ã§ã™ã€‚
```
<path> ::= <segment> ("." <segment>)*
<segment> ::= <identifier> | <quotedIdentifier>
```

> **æ³¨è¨˜ï¼ˆå®Ÿè£…ä»•æ§˜ï¼‰ï¼š**
> - **ï¼ˆä¾‹: `"field name"`ï¼‰ã‚‚å«ã‚ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆå›²ã¿ã¯Lexerï¼ˆChevrotainï¼‰ã®éƒ½åˆã«ã‚ˆã‚Šå…¨ã¦ `StringLiteral` ãƒˆãƒ¼ã‚¯ãƒ³ã§ä¸€æ‹¬èªè­˜**ã—ã¾ã™ã€‚
> - **Parser/Visitorã§ã¯`<path>`ã‚„`<segment>`æ–‡è„ˆã§ç¾ã‚ŒãŸ`StringLiteral`ã‚’æ„å‘³çš„ã«`<quotedIdentifier>`ã¨ã—ã¦å‡¦ç†**ã—ã¾ã™ï¼ˆ`segments`ã®è¦ç´ ã¨ã—ã¦æ ¼ç´ï¼‰ã€‚å€¤ï¼ˆãƒªãƒ†ãƒ©ãƒ«ï¼‰æ–‡è„ˆã§ã¯é€šå¸¸ã®æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
> - Lexerã«ã€ŒQuotedIdentifierã€ãƒˆãƒ¼ã‚¯ãƒ³å‹ã¯**å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“**ï¼ˆè¨­è¨ˆçµŒç·¯ã¯parser.mdå‚ç…§ï¼‰ã€‚
> - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ã®å…ˆé ­ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ Identifier ã‚’åŸå‰‡ã¨ã—ã¾ã™ã€‚  
> - Dotï¼ˆ`.`ï¼‰ä»¥é™ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§ã¯ã€ã‚¯ã‚ªãƒ¼ãƒˆè­˜åˆ¥å­ï¼ˆ`"..."`ï¼‰ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼ˆä¾‹: `ideas."ğŸ’¬comments"`, `sales."2021"`ï¼‰ã€‚  
> - å…ˆé ­ã‚¯ã‚ªãƒ¼ãƒˆè­˜åˆ¥å­ï¼ˆä¾‹: `"2021 sales"`) ã¯ Phase1 ã§ã¯éå¯¾å¿œï¼ˆå°†æ¥æ‹¡å¼µã‚’æ¤œè¨ï¼‰ã§ã™ã€‚



### **4.3 è­˜åˆ¥å­ï¼ˆIdentifierï¼‰ã®ãƒ«ãƒ¼ãƒ«**
- è‹±å­—ã€æ•°å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢(`_`)ã€ãƒã‚¤ãƒ•ãƒ³(`-`)ã®çµ„ã¿åˆã‚ã›ãŒä½¿ç”¨å¯èƒ½ã§ã™ã€‚ï¼ˆä¾‹: `author_name`, `product-id`ï¼‰
- æ•°å­—ã®ã¿ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚‚è¨±å®¹ã•ã‚Œã¾ã™ã€‚ï¼ˆä¾‹: `items.0.name`ï¼‰
- ãƒ‰ãƒƒãƒˆ `.` ã¯ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®åŒºåˆ‡ã‚Šæ–‡å­—ã¨ã¿ãªã•ã‚Œã‚‹ãŸã‚ã€è­˜åˆ¥å­å†…éƒ¨ã«ã¯å«ã‚ã‚‰ã‚Œã¾ã›ã‚“ã€‚

### **4.4 ã‚¯ã‚ªãƒ¼ãƒˆè­˜åˆ¥å­ï¼ˆQuoted Identifierï¼‰**
ã‚¹ãƒšãƒ¼ã‚¹ã€äºˆç´„èªã€ç‰¹æ®Šè¨˜å·ï¼ˆ`.`ãªã©ï¼‰ã‚’å«ã‚€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆ `""` ã§å›²ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
- å†…éƒ¨ã®ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã¯ `\"`ã€ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã¯ `\\` ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ã¾ã™ã€‚
- ä¾‹: `"author.name"`ï¼ˆãƒ‰ãƒƒãƒˆã‚’å«ã‚€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼‰ã€`"special key"`ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚’å«ã‚€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åï¼‰

### **4.5 äºˆç´„èªã®åˆ¶ç´„**
`AND`, `OR`, `NOT` ã¯è«–ç†æ¼”ç®—å­ã¨ã—ã¦äºˆç´„ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¨ã—ã¦ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€å¿…ãšã‚¯ã‚ªãƒ¼ãƒˆã§å›²ã‚“ã§ãã ã•ã„ï¼ˆä¾‹: `"AND"`, `"not"`ï¼‰ã€‚äºˆç´„èªã¯å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã›ãšã«æ‰±ã‚ã‚Œã¾ã™ã€‚

### **4.6 å®Ÿç”¨ä¾‹ã¨è©•ä¾¡ãƒ¢ãƒ‡ãƒ«**
#### 1. ãƒã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
**DSL**: `author.name="Bar Curion"`  
**æ„å‘³**: `author` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã® `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ `"Bar Curion"` ã¨å®Œå…¨ä¸€è‡´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{
  "author": { "name": "Bar Curion", "country": "JP" }
}
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**

#### 2. é…åˆ—è¦ç´ ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆæš—é»™ã® `any`ï¼‰
**DSL**: `ingredients.name:"ã‚¸ãƒ³"`  
**æ„å‘³**: `ingredients` é…åˆ—ã®ã„ãšã‚Œã‹ã®è¦ç´ ã§ã€`name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œã‚¸ãƒ³ã€ã¨ã„ã†æ–‡å­—åˆ—ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{
  "ingredients": [
    { "name": "ã‚¸ãƒ³", "amount": "30ml" },
    { "name": "ãƒ‰ãƒ©ã‚¤ãƒ»ãƒ™ãƒ«ãƒ¢ãƒƒãƒˆ", "amount": "10ml" }
  ]
}
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™**ï¼ˆ1ç•ªç›®ã®è¦ç´ ãŒæ¡ä»¶ã‚’æº€ãŸã™ãŸã‚ï¼‰ã€‚

#### 3. æ˜ç¤ºçš„ãªé…åˆ—ä½œç”¨ï¼ˆ`all` / `none`ï¼‰
**DSL**: `all(ingredients, type="ãƒªã‚­ãƒ¥ãƒ¼ãƒ«")`  
**æ„å‘³**: `ingredients` é…åˆ—ã® **ã™ã¹ã¦ã®è¦ç´ ** ãŒ `type` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒ `"ãƒªã‚­ãƒ¥ãƒ¼ãƒ«"` ã§ã‚ã‚‹å ´åˆã«ãƒãƒƒãƒã—ã¾ã™ã€‚ï¼ˆè©³ç´°ã¯ **ç¬¬8ç« ** ã‚’å‚ç…§ï¼‰

#### è©•ä¾¡ã‚¤ãƒ¡ãƒ¼ã‚¸
```mermaid
flowchart TD
Â  subgraph ãƒã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¾‹
Â  Â  A[ãƒ‡ãƒ¼ã‚¿: author ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ] -->|ã‚¢ã‚¯ã‚»ã‚¹| B[name ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰]
Â  Â  B -->|å€¤: 'Bar Curion'| C[æ¯”è¼ƒå‡¦ç†]
Â  Â  C --> D[çµæœ: true / false]
Â  end


Â  subgraph é…åˆ—ä¾‹
Â  Â  E[ãƒ‡ãƒ¼ã‚¿: ingredients é…åˆ—] -->|å„è¦ç´ ã‚’è©•ä¾¡| F[è¦ç´ 1: name = 'ã‚¸ãƒ³', ...]
Â  Â  E -->|å„è¦ç´ ã‚’è©•ä¾¡| G[è¦ç´ 2: name = 'ãƒ™ãƒ«ãƒ¢ãƒƒãƒˆ', ...]
Â  Â  F --> H[name ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æŠ½å‡º]
Â  Â  G --> I[name ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æŠ½å‡º]
Â  Â  H --> J["contains(ã‚¸ãƒ³)è©•ä¾¡"]
Â  Â  I --> K["contains(ã‚¸ãƒ³)è©•ä¾¡"]
Â  Â  J --> L[è¦ç´ 1ã¯ãƒãƒƒãƒ]
Â  Â  K --> M[è¦ç´ 2ã¯ä¸ä¸€è‡´]
Â  Â  L -- any åˆ¤å®šã§1ã¤ãƒãƒƒãƒã™ã‚Œã°OK Â --> N[çµæœ: ãƒãƒƒãƒ]
Â  end
```

> **ãƒã‚¤ãƒ³ãƒˆ**: åŒã˜ `path.to.field` ã¨ã„ã†æ›¸ãæ–¹ã§ã‚‚ã€å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹é…åˆ—ã‹ã«ã‚ˆã£ã¦è©•ä¾¡ãƒ­ã‚¸ãƒƒã‚¯ãŒç•°ãªã‚Šã¾ã™ã€‚æœ¬DSLã§ã¯ã€é…åˆ—ã®å ´åˆã¯ `any` ã‚’æš—é»™çš„ã«é©ç”¨ã™ã‚‹ã“ã¨ã§ã€åˆ©ç”¨è€…ã®è¨˜è¿°è² æ‹…ã‚’è»½æ¸›ã—ã¦ã„ã¾ã™ã€‚

***

## **ç¬¬5ç« ã€€ãƒªãƒ†ãƒ©ãƒ«ï¼ˆæ–‡å­—åˆ— / æ•°å€¤ / ãƒ–ãƒ¼ãƒ« / null ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰**

ã“ã®ç« ã§ã¯ã€DSLã«ãŠã‘ã‚‹å€¤ï¼ˆãƒªãƒ†ãƒ©ãƒ«ï¼‰ã®ç¨®é¡ã¨è¡¨è¨˜æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ãƒªãƒ†ãƒ©ãƒ«ã¯ã€æ¯”è¼ƒæ¡ä»¶ã®å³è¾ºãªã©ã§ä½¿ç”¨ã•ã‚Œã‚‹å…·ä½“çš„ãªå€¤ã§ã™ã€‚

### **5.1 ãƒªãƒ†ãƒ©ãƒ«ã®ç¨®é¡**
æœ¬DSLã§ã¯ã€JSONã§è¡¨ç¾å¯èƒ½ãªä¸»è¦ãªãƒ‡ãƒ¼ã‚¿å‹ã«å¯¾å¿œã™ã‚‹ãƒªãƒ†ãƒ©ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
- **æ–‡å­—åˆ—** (string)
- **æ•°å€¤** (number)
- **çœŸå½å€¤** (boolean)
- **null**

### **5.2 ãƒªãƒ†ãƒ©ãƒ«ã®æ›¸å¼**
#### **(1) æ–‡å­—åˆ— (string)**
- ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆ `""` ã§å›²ã‚“ã§è¡¨ç¾ã—ã¾ã™ã€‚
- ä»¥ä¸‹ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒåˆ©ç”¨å¯èƒ½ã§ã™: `\"` (ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆ), `\\` (ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥), `\n` (æ”¹è¡Œ), `\t` (ã‚¿ãƒ–), `\r` (å¾©å¸°)ã€‚
- `path:value` ã®çœç•¥å½¢ã«ãŠã‘ã‚‹ã‚¯ã‚ªãƒ¼ãƒˆãªã—ã® `value` ã‚‚æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
- ä¾‹: `name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹"`, `description:"A classic cocktail\n"`

#### **(2) æ•°å€¤ (number)**
- æ•´æ•°ã€è² æ•°ã€å°æ•°ã€ãŠã‚ˆã³æŒ‡æ•°è¡¨è¨˜ï¼ˆ`e`ã¾ãŸã¯`E`ï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
- ä¾‹: `alcohol_content=40`, `price=-2.5`, `tolerance=1e-5`

#### **(3) çœŸå½å€¤ (boolean)**
- å°æ–‡å­—ã® `true` ã¾ãŸã¯ `false` ã§è¡¨ç¾ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯äºˆç´„èªã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
- ä¾‹: `is_available=true`

#### **(4) null**
- å°æ–‡å­—ã® `null` ã§è¡¨ç¾ã—ã¾ã™ã€‚ã“ã‚Œã‚‚äºˆç´„èªã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
- ä¾‹: `notes=null`

### **5.3 å‹åˆ¤åˆ¥ã®å„ªå…ˆåº¦**
ãƒ‘ãƒ¼ã‚µãƒ¼ãŒå€¤ã‚’è§£é‡ˆã™ã‚‹éš›ã®å‹åˆ¤åˆ¥ã¯ã€ä»¥ä¸‹ã®å„ªå…ˆé †ä½ã§è¡Œã‚ã‚Œã¾ã™ã€‚
1.  **äºˆç´„èª**: `true`, `false`, `null` ã¯æœ€å„ªå…ˆã§ãã‚Œãã‚Œã®å‹ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¾ã™ã€‚
2.  **æ•°å€¤**: äºˆç´„èªã§ãªãã€æ•°å€¤ã¨ã—ã¦æœ‰åŠ¹ãªå½¢å¼ã®å ´åˆã€æ•°å€¤å‹ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
3.  **æ–‡å­—åˆ—**: ä¸Šè¨˜ä»¥å¤–ã®å ´åˆã€ã¾ãŸã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚ªãƒ¼ãƒˆã§æ˜ç¤ºçš„ã«å›²ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€æ–‡å­—åˆ—å‹ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚

### **5.4 å‹ã¨æ¼”ç®—å­ã®çµ„ã¿åˆã‚ã›**
ãƒªãƒ†ãƒ©ãƒ«ã®å‹ã«ã‚ˆã£ã¦ã€ä½¿ç”¨ã§ãã‚‹æ¼”ç®—å­ãŒç•°ãªã‚Šã¾ã™ã€‚**å„æ¼”ç®—å­ã®è©³ç´°ãªä»•æ§˜ã¯å¾Œç¶šã®ç« ã§è§£èª¬ã—ã¾ã™ãŒã€ã“ã“ã§ã¯å…ˆã«å…¨ä½“çš„ãªå¯¾å¿œé–¢ä¿‚ã‚’ç¤ºã—ã¾ã™ã€‚**å‹ãŒä¸€è‡´ã—ãªã„æ¯”è¼ƒã¯ã€ã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚Šã¾ã›ã‚“ãŒè©•ä¾¡æ™‚ã«å¸¸ã« `false` ã¨ãªã‚Šã¾ã™ã€‚

| ãƒªãƒ†ãƒ©ãƒ«å‹ | ä½¿ç”¨å¯èƒ½ãªæ¼”ç®—å­ | å‚™è€ƒ |
| :--- | :--- | :--- |
| **æ•°å€¤** | `=`, `!=`, `>`, `>=`, `<`, `<=` | ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ï¼ˆ`contains`ç­‰ï¼‰ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚ |
| **æ–‡å­—åˆ—** | `=`, `!=`, `contains`, `startsWith`, `endsWith`, çœç•¥å½¢`:` | `=`ã¯å®Œå…¨ä¸€è‡´ã€`:`ã¯éƒ¨åˆ†ä¸€è‡´ã§ã™ã€‚å¤§å°æ¯”è¼ƒã¯v0.1ã§ã¯éå¯¾å¿œã§ã™ã€‚ |
| **çœŸå½å€¤** | `=`, `!=` | |
| **null** | `=`, `!=` | |

**å‹ä¸ä¸€è‡´ã®ä¾‹**: ã‚¯ã‚¨ãƒª `alcohol_content:"20"` ã¯æ§‹æ–‡ä¸Šæœ‰åŠ¹ã§ã™ãŒã€`alcohol_content` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ•°å€¤å‹ã®å ´åˆã€æ–‡å­—åˆ— `"20"` ã¨ã®æ¯”è¼ƒã¯å¸¸ã« `false` ã¨ãªã‚Šã¾ã™ã€‚æ­£ã—ãã¯ `alcohol_content=20` ã§ã™ã€‚

***

## **ç¬¬6ç«  æ¯”è¼ƒæ¼”ç®—ï¼ˆ=, !=, >, >=, <, <=ï¼‰**

ã“ã®ç« ã§ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã¨ãƒªãƒ†ãƒ©ãƒ«ã‚’æ¯”è¼ƒã™ã‚‹ãŸã‚ã®æ¼”ç®—å­ã«ã¤ã„ã¦è©³è¿°ã—ã¾ã™ã€‚

### **6.1 æ¦‚è¦**
æ¯”è¼ƒæ¼”ç®—ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’ç‰¹å®šã®å€¤ã¨ç­‰ã—ã„ã‹ã€å¤§å°é–¢ä¿‚ã«ã‚ã‚‹ã‹ãªã©ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ç”¨ã„ã¾ã™ã€‚æ•°å€¤ã€æ–‡å­—åˆ—ã€çœŸå½å€¤ã€nullã«å¯¾ã—ã¦ä½¿ç”¨ã§ãã¾ã™ãŒã€å‹ã«ã‚ˆã£ã¦åˆ©ç”¨å¯èƒ½ãªæ¼”ç®—å­ãŒç•°ãªã‚Šã¾ã™ï¼ˆ**ç¬¬5ç«  5.4**å‚ç…§ï¼‰ã€‚

### **6.2 æ§‹æ–‡**
æ¯”è¼ƒæ¼”ç®—ã«ã¯ã€æ¼”ç®—å­ã‚’æ˜ç¤ºã™ã‚‹æ¨™æº–çš„ãªå½¢å¼ã¨ã€ã‚³ãƒ­ãƒ³ `:` ã‚’ç”¨ã„ãŸçœç•¥å½¢ãŒã‚ã‚Šã¾ã™ã€‚

- **æ¨™æº–å½¢**: `ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹ æ¼”ç®—å­ å€¤`
  - ä¾‹: `alcohol_content > 20`
  - ä¾‹: `author.name = "Bar Curion"`
- **çœç•¥å½¢**: `ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹:æ¼”ç®—å­å€¤`
  - ä¾‹: `alcohol_content:>20`
  - ä¾‹: `author.name:="Bar Curion"`

ã©ã¡ã‚‰ã®å½¢å¼ã‚‚ç­‰ä¾¡ã§ã™ãŒã€çœç•¥å½¢ã¯ã‚ˆã‚Šç°¡æ½”ã«è¨˜è¿°ã§ãã¾ã™ã€‚æ¼”ç®—å­ã¨å€¤ã®é–“ã«ã‚¹ãƒšãƒ¼ã‚¹ã¯ä¸è¦ã§ã™ã€‚

### **6.3 å‹ã«å¿œã˜ãŸæŒ™å‹•**
- **æ•°å€¤**: ã™ã¹ã¦ã®æ¯”è¼ƒæ¼”ç®—å­ï¼ˆ`=`, `!=`, `>`, `>=`, `<`, `<=`ï¼‰ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚è¤‡æ•°ã®æ¯”è¼ƒã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ç¯„å›²æŒ‡å®šãŒã§ãã¾ã™ï¼ˆ**ç¬¬9ç« **å‚ç…§ï¼‰ã€‚
- **æ–‡å­—åˆ—**: `=` ã¯ **å®Œå…¨ä¸€è‡´**ã€`!=` ã¯ **å®Œå…¨ä¸ä¸€è‡´** ã‚’è©•ä¾¡ã—ã¾ã™ã€‚v0.1ã§ã¯å¤§å°æ¯”è¼ƒï¼ˆ`>`, `<` ç­‰ï¼‰ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ã¯ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ï¼ˆ**ç¬¬7ç« **ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
- **çœŸå½å€¤ãƒ»null**: `=` ã¨ `!=` ã®ã¿åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

### **6.4 å…·ä½“ä¾‹**
#### **æ•°å€¤ã®æ¯”è¼ƒ**
**DSL**: `price <= 1000`  
**æ„å‘³**: `price` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒ `1000` ä»¥ä¸‹ã§ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{ "name": "Standard Drink", "price": 800 }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**

#### **æ–‡å­—åˆ—ã®å®Œå…¨ä¸€è‡´**
**DSL**: `category = "ã‚¹ãƒ”ãƒªãƒƒãƒ„"`  
**æ„å‘³**: `category` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒ `"ã‚¹ãƒ”ãƒªãƒƒãƒ„"` ã¨ã„ã†æ–‡å­—åˆ—ã¨å®Œå…¨ã«ä¸€è‡´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{ "name": "ã‚¸ãƒ³", "category": "ã‚¹ãƒ”ãƒªãƒƒãƒ„" }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**
```json
{ "name": "ã‚¸ãƒ³", "category": "ã‚¹ãƒ”ãƒªãƒƒãƒ„é¡" }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã›ã‚“**ï¼ˆå®Œå…¨ä¸€è‡´ã§ã¯ãªã„ãŸã‚ï¼‰ã€‚

#### **nullã®åˆ¤å®š**
**DSL**: `imageUrl != null`  
**æ„å‘³**: `imageUrl` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒ `null` ã§ã¯ãªã„ï¼ˆã¤ã¾ã‚Šä½•ã‚‰ã‹ã®å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼‰ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  

### **6.5 æ³¨æ„ç‚¹**
- **å‹ä¸ä¸€è‡´**: `price > "high"` ã®ã‚ˆã†ãªã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ã¨ãƒªãƒ†ãƒ©ãƒ«ã®å‹ãŒç•°ãªã‚‹æ¯”è¼ƒã¯ã€æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚Šã¾ã›ã‚“ãŒã€è©•ä¾¡çµæœã¯å¸¸ã« `false` ã¨ãªã‚Šã¾ã™ã€‚
- **æ¼”ç®—å­ã¨ã‚¹ãƒšãƒ¼ã‚¹**: `alcohol_content > 20` ã¨ `alcohol_content>20` ã¯ç­‰ä¾¡ã§ã™ã€‚å¯èª­æ€§ã®è¦³ç‚¹ã‹ã‚‰ã€æ¼”ç®—å­ã®å‰å¾Œã«ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

ã“ã®ç« ã§è§£èª¬ã—ãŸæ¯”è¼ƒæ¼”ç®—ã¯ã€DSLã®æœ€ã‚‚åŸºæœ¬çš„ãªæ§‹æˆè¦ç´ ã®ä¸€ã¤ã§ã™ã€‚æ¬¡ã®ç« ã§ã¯ã€æ–‡å­—åˆ—ã«ç‰¹åŒ–ã—ãŸãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

***

## **ç¬¬7ç«  ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ï¼ˆcontains / startsWith / endsWith ã¨çœç•¥å½¢ path:valueï¼‰**

ã“ã®ç« ã§ã¯ã€æ–‡å­—åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã™ã‚‹éƒ¨åˆ†ä¸€è‡´ã€å‰æ–¹ä¸€è‡´ã€å¾Œæ–¹ä¸€è‡´æ¤œç´¢ã‚’è¡Œã†ãŸã‚ã®ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### **7.1 æ¦‚è¦**
ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã¯ã€æ–‡å­—åˆ—ã®å®Œå…¨ä¸€è‡´ã‚ˆã‚Šã‚‚æŸ”è»Ÿãªæ¤œç´¢ã‚’å®Ÿç¾ã—ã¾ã™ã€‚v0.1ã§ã¯ `contains`, `startsWith`, `endsWith` ã®3ã¤ã®æ¼”ç®—ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚æœ€ã‚‚é »ç¹ã«åˆ©ç”¨ã•ã‚Œã‚‹ `contains` ã«ã¯ã€ä¾¿åˆ©ãªçœç•¥å½¢ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

### **7.2 æ§‹æ–‡**
ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã«ã¯ã€é–¢æ•°å½¢å¼ã¨çœç•¥å½¢ãŒã‚ã‚Šã¾ã™ã€‚

- **é–¢æ•°å½¢å¼**:
  - `contains(ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹, "æ¤œç´¢æ–‡å­—åˆ—")`
  - `startsWith(ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹, "æ¤œç´¢æ–‡å­—åˆ—")`
  - `endsWith(ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹, "æ¤œç´¢æ–‡å­—åˆ—")`
- **çœç•¥å½¢ï¼ˆ`contains` ã®ã¿ï¼‰**:
  - `ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹:"æ¤œç´¢æ–‡å­—åˆ—"`

çœç•¥å½¢ `name:"ã‚¸ãƒ³"` ã¯ã€é–¢æ•°å½¢å¼ `contains(name, "ã‚¸ãƒ³")` ã¨å®Œå…¨ã«ç­‰ä¾¡ã§ã‚ã‚Šã€è¨˜è¿°ã®ç°¡æ½”ã•ã‹ã‚‰ã“ã¡ã‚‰ã®åˆ©ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

> ä»•æ§˜æ³¨è¨˜ï¼ˆv0.2 ç¾çŠ¶ï¼‰:
> - é–¢æ•°å½¢å¼ã¯ 2 å¼•æ•° `(path, "string")` ã®ã¿ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚  
> - 1 å¼•æ•°ï¼ˆä¾‹: `contains("text")`ï¼‰ã«ã‚ˆã‚‹å…¨æ–‡æ¤œç´¢ã®ç³–è¡£æ§‹æ–‡ã¯å°†æ¥æ‹¡å¼µã¨ã—ã¦æ¤œè¨ä¸­ã§ã™ï¼ˆè¤‡æ•°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸ã® OR å±•é–‹ãªã©ã®æŒ¯ã‚‹èˆã„ã‚’åˆ¥ç« ã«ã¦æ¤œè¨ï¼‰ã€‚


### **7.3 æŒ™å‹•ã¨è©•ä¾¡è¦å‰‡**
- **`contains`**: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ã«ã€æŒ‡å®šã—ãŸæ¤œç´¢æ–‡å­—åˆ—ãŒ**å«ã¾ã‚Œã‚‹**å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚
- **`startsWith`**: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ãŒã€æŒ‡å®šã—ãŸæ¤œç´¢æ–‡å­—åˆ—ã§**å§‹ã¾ã‚‹**å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚
- **`endsWith`**: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ãŒã€æŒ‡å®šã—ãŸæ¤œç´¢æ–‡å­—åˆ—ã§**çµ‚ã‚ã‚‹**å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚
- **å¤§æ–‡å­—å°æ–‡å­—ã®åŒºåˆ¥**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥ã—ã¾ã™ï¼ˆä¾‹: `contains(name, "Gin")` ã¯ `"GIN"` ã«ã¯ãƒãƒƒãƒã—ã¾ã›ã‚“ï¼‰ã€‚`ignoreCase` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šå¤§å°ç„¡è¦–ã®æ¯”è¼ƒã«åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã§ã™ï¼ˆç¬¬13ç« å‚ç…§ï¼‰ã€‚
- **éæ–‡å­—åˆ—å‹ã¸ã®é©ç”¨**: å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ–‡å­—åˆ—ã§ãªã„å ´åˆï¼ˆæ•°å€¤ã€nullç­‰ï¼‰ã€ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã®è©•ä¾¡çµæœã¯å¸¸ã« `false` ã¨ãªã‚Šã¾ã™ã€‚
- ç¬¬2å¼•æ•°ã¯æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã«é™ã‚Šã¾ã™ã€‚æ–‡å­—åˆ—ä»¥å¤–ï¼ˆä¾‹: æ•°å€¤ï¼‰ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ï¼ˆä¾‹: `text functions require a string literal as the second argument`ï¼‰ã€‚
- **å¤§æ–‡å­—å°æ–‡å­—ãƒ»ãƒ€ã‚¤ã‚¢ã‚¯ãƒªãƒ†ã‚£ã‚¯ã‚¹ã®å‰å‡¦ç†**: 
  - ignoreCaseï¼ˆå®Ÿè£…ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰: true ã®å ´åˆã€æ¯”è¼ƒå‰ã« toLocaleLowerCase(locale) ã‚’é©ç”¨ã™ã‚‹ã€‚å°æ–‡å­—åŒ–ã¯ãƒ­ã‚±ãƒ¼ãƒ«ä¾å­˜ã§ã‚ã‚Šã€ä¾‹ã¨ã—ã¦ â€œIâ€ ã¯ en-US ã§ã¯ â€œiâ€ã€tr ã§ã¯ â€œÄ±â€ ã«å°æ–‡å­—åŒ–ã•ã‚Œã‚‹ã€‚
  - foldDiacriticsï¼ˆå®Ÿè£…ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰: true ã®å ´åˆã€æ¯”è¼ƒå‰ã« NFD æ­£è¦åŒ–ã¨çµåˆãƒ€ã‚¤ã‚¢ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒãƒ¼ã‚¯ï¼ˆU+0300â€“U+036Fï¼‰ã®é™¤å»ã‚’è¡Œã†ã€‚ã“ã‚Œã«ã‚ˆã‚Š â€œCafÃ©â€ ã¯ â€œCafeâ€ ã¨ã—ã¦ç…§åˆã•ã‚Œã‚‹ã€‚
  - å‡¦ç†é †åº: foldDiacritics â†’ ignoreCase ã®é †ã«é©ç”¨ã™ã‚‹ã€‚


### **7.4 å…·ä½“ä¾‹**
#### **éƒ¨åˆ†ä¸€è‡´ï¼ˆçœç•¥å½¢ï¼‰**
**DSL**: `name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹"`  
**æ„å‘³**: `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œãƒãƒ†ã‚£ãƒ¼ãƒ‹ã€ã¨ã„ã†æ–‡å­—åˆ—ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{ "name": "ãƒ‰ãƒ©ã‚¤ãƒ»ãƒãƒ†ã‚£ãƒ¼ãƒ‹" }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**

#### **å‰æ–¹ä¸€è‡´**
**DSL**: `startsWith(name, "ãƒ‰ãƒ©ã‚¤")`  
**æ„å‘³**: `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã€Œãƒ‰ãƒ©ã‚¤ã€ã§å§‹ã¾ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{ "name": "ãƒ‰ãƒ©ã‚¤ãƒ»ã‚¸ãƒ³" }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**
```json
{ "name": "ã‚´ãƒ¼ãƒ‰ãƒ³ãƒ»ãƒ‰ãƒ©ã‚¤ãƒ»ã‚¸ãƒ³" }
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã›ã‚“**ï¼ˆå‰æ–¹ä¸€è‡´ã§ã¯ãªã„ãŸã‚ï¼‰ã€‚

#### **å¾Œæ–¹ä¸€è‡´**
**DSL**: `endsWith(garnish.name, "ãƒ”ãƒ¼ãƒ«")`  
**æ„å‘³**: `garnish` é…åˆ—ã®ã„ãšã‚Œã‹ã®è¦ç´ ã§ã€`name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã€Œãƒ”ãƒ¼ãƒ«ã€ã§çµ‚ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚  
**å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
```json
{
  "garnish": [{ "name": "ãƒ¬ãƒ¢ãƒ³ãƒ”ãƒ¼ãƒ«" }]
}
```
**è©•ä¾¡çµæœ**: **ãƒãƒƒãƒã—ã¾ã™ã€‚**

### **7.5 å®Œå…¨ä¸€è‡´ï¼ˆ`=`ï¼‰ã¨ã®é•ã„**
`=` æ¼”ç®—å­ã¯æ–‡å­—åˆ—å…¨ä½“ãŒå®Œå…¨ã«ä¸€è‡´ã™ã‚‹å ´åˆã«ã®ã¿çœŸã¨ãªã‚Šã¾ã™ãŒã€ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ã¯éƒ¨åˆ†çš„ãªä¸€è‡´ã‚’è¨±å®¹ã—ã¾ã™ã€‚
- `name = "ã‚¸ãƒ³"`: `"ã‚¸ãƒ³"` ã«ã®ã¿ãƒãƒƒãƒã€‚
- `name:"ã‚¸ãƒ³"` (`contains`): `"ã‚¸ãƒ³"`, `"ãƒ‰ãƒ©ã‚¤ãƒ»ã‚¸ãƒ³"`, `"ã‚¸ãƒ³ãƒ»ãƒˆãƒ‹ãƒƒã‚¯"` ãªã©ã«ãƒãƒƒãƒã€‚

ç”¨é€”ã«å¿œã˜ã¦é©åˆ‡ã«ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

***

## **ç¬¬8ç«  é…åˆ—ä½œç”¨ï¼ˆany/all/noneã€ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã¨åŒä¸€è¦ç´ ANDï¼‰**

ã“ã®ç« ã§ã¯ã€é…åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å†…ã®è¦ç´ ã‚’ã©ã®ã‚ˆã†ã«è©•ä¾¡ã™ã‚‹ã‹ã‚’åˆ¶å¾¡ã™ã‚‹ã€Œé‡åŒ–å­ï¼ˆQuantifierï¼‰ã€ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### **8.1 æ¦‚è¦**
JSONãƒ‡ãƒ¼ã‚¿ã§ã¯ã€ä¸€ã¤ã®ã‚­ãƒ¼ã«å¯¾ã—ã¦è¤‡æ•°ã®å€¤ã‚’é…åˆ—ã¨ã—ã¦æŒã¤ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚æœ¬DSLã§ã¯ã€é…åˆ—ã®è¦ç´ ã«å¯¾ã—ã¦ã€Œã„ãšã‚Œã‹ä¸€ã¤ã§ã‚‚ã€ã€Œã™ã¹ã¦ãŒã€ã€Œã„ãšã‚Œã‚‚ï½ãªã„ã€ã¨ã„ã£ãŸæ¡ä»¶ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã® `any`, `all`, `none` ã®3ã¤ã®é‡åŒ–å­ã‚’æä¾›ã—ã¾ã™ã€‚

### **8.2 é‡åŒ–å­ã®ç¨®é¡ã¨æ„å‘³**
- **`any(path, condition)`**: é…åˆ— `path` ã®è¦ç´ ã®ã†ã¡ã€**1ã¤ã§ã‚‚** `condition` ã‚’æº€ãŸã™ã‚‚ã®ãŒã‚ã‚Œã°çœŸã¨ãªã‚Šã¾ã™ã€‚
- **`all(path, condition)`**: é…åˆ— `path` ã® **ã™ã¹ã¦ã®è¦ç´ ** ãŒ `condition` ã‚’æº€ãŸã™å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚
- **`none(path, condition)`**: é…åˆ— `path` ã® **ã©ã®è¦ç´ ã‚‚** `condition` ã‚’æº€ãŸã•ãªã„å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚

> ä»•æ§˜æ³¨è¨˜ï¼ˆå¼•æ•°æ•°ï¼‰:
> - `any` / `all` / `none` ã¯ 2 å¼•æ•° `(path, condition)` ãŒå¿…é ˆã§ã™ã€‚  
> - å¼•æ•°ä¸è¶³ï¼ˆä¾‹: `any(items)`ï¼‰ã¯ç¾ä»•æ§˜ã§ã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ï¼ˆå°†æ¥ã€æ­£è¦åŒ–æ®µéšã§ã®ã‚¨ãƒ©ãƒ¼åŒ–ã«ç§»è¡Œã™ã‚‹å¯èƒ½æ€§ã‚ã‚Šï¼‰ã€‚


### **8.3 ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ï¼ˆæš—é»™ã® `any`ï¼‰**
é…åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦ç›´æ¥æ¡ä»¶ã‚’è¨˜è¿°ã—ãŸå ´åˆã€è‡ªå‹•çš„ã« `any` ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯æœ€ã‚‚ä¸€èˆ¬çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’ç°¡æ½”ã«è¨˜è¿°ã™ã‚‹ãŸã‚ã®ä»•æ§˜ã§ã™ã€‚
- **DSL**: `ingredients.name:"ã‚¸ãƒ³"`
- **è§£é‡ˆ**: `any(ingredients, contains(name, "ã‚¸ãƒ³"))`

### **8.4 åŒä¸€è¦ç´ å†…AND**
é…åˆ—ã® **åŒã˜è¦ç´ å†…**ã§è¤‡æ•°ã®æ¡ä»¶ã‚’åŒæ™‚ã«æº€ãŸã™å¿…è¦ãŒã‚ã‚‹å ´åˆã€é…åˆ—åã®ç›´å¾Œã§æ¡ä»¶ã‚’ `()` ã§ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã—ã¾ã™ã€‚
- **DSL**: `ingredients:(name:"ã‚¸ãƒ³" AND type:"ã‚¹ãƒ”ãƒªãƒƒãƒ„")`
- **æ„å‘³**: `ingredients` é…åˆ—å†…ã«ã€`name` ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã¿ã€**ã‹ã¤** `type` ãŒã€Œã‚¹ãƒ”ãƒªãƒƒãƒ„ã€ã§ã‚ã‚‹ã€ã¨ã„ã†2ã¤ã®æ¡ä»¶ã‚’**åŒæ™‚ã«æº€ãŸã™è¦ç´ **ãŒ1ã¤ä»¥ä¸Šå­˜åœ¨ã™ã‚‹å ´åˆã«çœŸã¨ãªã‚Šã¾ã™ã€‚
- **å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ä¾‹**:
  ```json
  // ãƒãƒƒãƒã™ã‚‹ä¾‹
  {
    "ingredients": [
      { "name": "ãƒ‰ãƒ©ã‚¤ãƒ»ã‚¸ãƒ³", "type": "ã‚¹ãƒ”ãƒªãƒƒãƒ„" }, // ã“ã®è¦ç´ ãŒæ¡ä»¶ã‚’æº€ãŸã™
      { "name": "ãƒˆãƒ‹ãƒƒã‚¯ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼", "type": "ã‚½ãƒ•ãƒˆãƒ‰ãƒªãƒ³ã‚¯" }
    ]
  }
  // ãƒãƒƒãƒã—ãªã„ä¾‹
  {
    "ingredients": [
      { "name": "ãƒ‰ãƒ©ã‚¤ãƒ»ã‚¸ãƒ³", "type": "ãã®ä»–" },    // typeãŒé•ã†
      { "name": "ãƒ™ãƒ«ãƒ¢ãƒƒãƒˆ", "type": "ã‚¹ãƒ”ãƒªãƒƒãƒ„" }      // nameãŒé•ã†
    ]
  }
  ```

### **8.5 å…·ä½“ä¾‹**
#### **`all` ã®ä½¿ç”¨ä¾‹**
**DSL**: `all(ingredients, amount_ml > 0)`  
**æ„å‘³**: `ingredients` é…åˆ—ã® **ã™ã¹ã¦ã®è¦ç´ ** ã§ `amount_ml` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ `0` ã‚ˆã‚Šå¤§ãã„å ´åˆã«ãƒãƒƒãƒã—ã¾ã™ã€‚

#### **`none` ã®ä½¿ç”¨ä¾‹**
**DSL**: `none(ingredients, name:"ç ‚ç³–")`  
**æ„å‘³**: `ingredients` é…åˆ—ã® **ã©ã®è¦ç´ ** ã® `name` ã«ã‚‚ã€Œç ‚ç³–ã€ãŒå«ã¾ã‚Œã¦ã„ãªã„å ´åˆã«ãƒãƒƒãƒã—ã¾ã™ã€‚ã“ã‚Œã¯ `NOT ingredients.name:"ç ‚ç³–"` ã¨ç­‰ä¾¡ã§ã™ã€‚

### **8.6 ç©ºé…åˆ—ã®æ‰±ã„**
v0.1ä»•æ§˜ã§ã¯ã€å¯¾è±¡ã®é…åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒå­˜åœ¨ã—ãªã„ã€ã¾ãŸã¯ç©ºé…åˆ—ã§ã‚ã‚‹å ´åˆã®æŒ™å‹•ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šã‚ã¾ã™ã€‚
- `any(path, condition)`: `false`ï¼ˆæ¡ä»¶ã‚’æº€ãŸã™è¦ç´ ãŒä¸€ã¤ã‚‚ãªã„ãŸã‚ï¼‰
- `all(path, condition)`: `true`ï¼ˆæ¡ä»¶ã‚’ç ´ã‚‹è¦ç´ ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€‚ã€Œç©ºè™šãªçœŸã€ï¼‰
- `none(path, condition)`: `true`ï¼ˆæ¡ä»¶ã‚’æº€ãŸã™è¦ç´ ãŒä¸€ã¤ã‚‚ãªã„ãŸã‚ï¼‰

ã“ã®ç« ã§èª¬æ˜ã—ãŸé‡åŒ–å­ã¯ã€é…åˆ—ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«å¯¾ã—ã¦æŸ”è»Ÿãªã‚¯ã‚¨ãƒªã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚

***

## **ç¬¬9ç«  è¤‡åˆå€¤ãƒ»è¤‡åˆæ¡ä»¶ï¼ˆpath:(...), æ–‡å­—åˆ—ã®ORã€æ¯”è¼ƒã®ANDï¼‰**

ã“ã®ç« ã§ã¯ã€åŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦è¤‡æ•°ã®å€¤ã‚„æ¡ä»¶ã‚’ã¾ã¨ã‚ã¦è¨˜è¿°ã™ã‚‹ãŸã‚ã®æ§‹æ–‡ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

### **9.1 æ¦‚è¦**
`field:("A", "B")` ã‚„ `field:(>10, <20)` ã®ã‚ˆã†ã«ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®ç›´å¾Œã® `()` å†…ã«è¤‡æ•°ã®å€¤ã‚„æ¯”è¼ƒæ¡ä»¶ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€ã‚¯ã‚¨ãƒªã‚’ç°¡æ½”ã«è¡¨ç¾ã§ãã¾ã™ã€‚ã“ã®æ§‹æ–‡ã®æŒ™å‹•ã¯ã€å¯¾è±¡ã¨ãªã‚‹å€¤ã®å‹ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚

### **9.2 æ–‡å­—åˆ—ã®è¤‡æ•°æŒ‡å®šï¼ˆæš—é»™ã®ORï¼‰**
è¤‡æ•°ã®æ–‡å­—åˆ—ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§ãƒªã‚¹ãƒˆã—ãŸå ´åˆã€ãã‚Œã‚‰ã¯ **`OR`** æ¡ä»¶ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¾ã™ã€‚
- **DSL**: `name:("ãƒãƒ†ã‚£ãƒ¼ãƒ‹", "ãƒãƒ³ãƒãƒƒã‚¿ãƒ³")`
- **æ„å‘³**: `name` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œãƒãƒ†ã‚£ãƒ¼ãƒ‹ã€ã‚’å«ã‚€ã€**ã¾ãŸã¯**ã€Œãƒãƒ³ãƒãƒƒã‚¿ãƒ³ã€ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚
- **è§£é‡ˆ**: `name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹" OR name:"ãƒãƒ³ãƒãƒƒã‚¿ãƒ³"`

>- å†…éƒ¨ã§ã¯ã€`name: "foo"` ã¯ `contains(name, "foo")` ã¨ã—ã¦è©•ä¾¡ã•ã‚Œã¾ã™ã€‚  
>

### **9.3 æ•°å€¤æ¯”è¼ƒã®è¤‡æ•°æŒ‡å®šï¼ˆæš—é»™ã®ANDï¼‰**
è¤‡æ•°ã®æ¯”è¼ƒæ¡ä»¶ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§ãƒªã‚¹ãƒˆã—ãŸå ´åˆã€ãã‚Œã‚‰ã¯ **`AND`** æ¡ä»¶ã¨ã—ã¦è§£é‡ˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯æ•°å€¤ã®ç¯„å›²æŒ‡å®šã‚’ç°¡æ½”ã«è¨˜è¿°ã™ã‚‹ãŸã‚ã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚
- **DSL**: `alcohol_content:(>5, <13)`
- **æ„å‘³**: `alcohol_content` ãŒ5ã‚ˆã‚Šå¤§ããã€**ã‹ã¤** 13æœªæº€ã§ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚
- **è§£é‡ˆ**: `alcohol_content > 5 AND alcohol_content < 13`

>- `rating: >4.5` ã¯ `rating > 4.5` ã¨ç­‰ä¾¡ã§ã™ï¼ˆæ¯”è¼ƒã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã®å±•é–‹ï¼‰ã€‚


### **9.4 AND/ORã®æ˜ç¤º**
æ‹¬å¼§å†…ã§ã¯ã€`AND` ã‚„ `OR` ã‚’æ˜ç¤ºçš„ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æŒ™å‹•ã‚’ä¸Šæ›¸ãã§ãã¾ã™ã€‚
- **æ–‡å­—åˆ—ã®AND**: `description:("ãƒ‰ãƒ©ã‚¤" AND "ã‚¸ãƒ³")`
  - æ„å‘³: `description` ã«ã€Œãƒ‰ãƒ©ã‚¤ã€ã¨ã€Œã‚¸ãƒ³ã€ã®ä¸¡æ–¹ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã€‚
- **æ•°å€¤ã®OR**: `price:(<500 OR >=2000)`
  - æ„å‘³: `price` ãŒ500æœªæº€ã€ã¾ãŸã¯2000ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã€‚

### **9.5 é…åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã®çµ„ã¿åˆã‚ã›**
ã“ã®è¤‡åˆæ¡ä»¶ã®æ§‹æ–‡ã¯ã€é…åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦ã‚‚æœ‰åŠ¹ã§ã™ã€‚æš—é»™ã® `any` ã¨çµ„ã¿åˆã‚ã•ã£ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

#### **è¦ç´ æ¨ªæ–­ORï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰**
**DSL**: `ingredients.name:("ã‚¸ãƒ³", "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`
**æ„å‘³**: ææ–™ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã‚€ã‹ã€ã¾ãŸã¯ã€Œã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã€ã‚’å«ã‚€è¦ç´ ãŒã‚ã‚Œã°ãƒãƒƒãƒã—ã¾ã™ã€‚
**è§£é‡ˆ**: `any(ingredients, name:"ã‚¸ãƒ³" OR name:"ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`

#### **è¦ç´ æ¨ªæ–­AND**
**DSL**: `ingredients.name:("ã‚¸ãƒ³" AND "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`
**æ„å‘³**: ææ–™ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã‚€è¦ç´ ãŒã‚ã‚Šã€**ã‹ã¤**ã€Œã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã€ã‚’å«ã‚€è¦ç´ ãŒã‚ã‚‹å ´åˆã«ãƒãƒƒãƒã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯**åˆ¥ã€…ã®è¦ç´ ã§ã‚ã£ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“**ã€‚
**è§£é‡ˆ**: `ingredients.name:"ã‚¸ãƒ³" AND ingredients.name:"ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼"`

> **æ³¨æ„**: ã“ã®æ›¸ãæ–¹ (`ingredients.name:("A" AND "B")`) ã¯ã€**åŒä¸€è¦ç´ å†…AND**ï¼ˆ**ç¬¬8ç«  8.4**å‚ç…§ï¼‰ã¨ã¯æ„å‘³ãŒç•°ãªã‚Šã¾ã™ã€‚åŒä¸€ã®ææ–™ãŒã€Œã‚¸ãƒ³ã€ã§ã‚ã‚Šã‹ã¤ã€Œã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã€ã§ã‚ã‚‹ã€ã¨ã„ã†æ¡ä»¶ã‚’æ„å›³ã™ã‚‹å ´åˆã¯ `ingredients:(name:"ã‚¸ãƒ³" AND name:"ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")` ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### **9.6 ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹**
- **å‹ã®æ··åœ¨**: `path:("A", >5)` ã®ã‚ˆã†ã«ã€æ–‡å­—åˆ—ã¨æ•°å€¤ã‚’ä¸€ã¤ã®ãƒªã‚¹ãƒˆã«æ··åœ¨ã•ã›ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚
- **ç©ºã®ãƒªã‚¹ãƒˆ**: `path:()` ã®ã‚ˆã†ã«ã€æ‹¬å¼§å†…ãŒç©ºã®å ´åˆã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚

***

## **ç¬¬10ç«  è«–ç†æ¼”ç®—ï¼ˆAND/OR/NOTã€æ‹¬å¼§ã€å„ªå…ˆé †ä½ï¼‰**

ã“ã®ç« ã§ã¯ã€è¤‡æ•°ã®æ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ã¦ã‚ˆã‚Šè¤‡é›‘ãªæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®è«–ç†æ¼”ç®—å­ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### **10.1 æ¦‚è¦**
æœ¬DSLã¯ã€`AND`, `OR`, `NOT` ã®3ã¤ã®åŸºæœ¬çš„ãªè«–ç†æ¼”ç®—å­ã¨ã€è©•ä¾¡é †åºã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®æ‹¬å¼§ `()` ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®æ¼”ç®—å­ã¯ã€å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ã¾ã›ã‚“ï¼ˆä¾‹: `and`, `or`, `not` ã§ã‚‚å¯ï¼‰ã€‚

### **10.2 æ¼”ç®—å­ã®å„ªå…ˆé †ä½ã¨çµåˆè¦å‰‡**
æ¼”ç®—å­ã®è©•ä¾¡ã¯ã€ä»¥ä¸‹ã®å„ªå…ˆé †ä½ï¼ˆé«˜ã„é †ï¼‰ã§è¡Œã‚ã‚Œã¾ã™ã€‚
1.  **`()` (æ‹¬å¼§)**: è©•ä¾¡é †åºã‚’æ˜ç¤ºçš„ã«åˆ¶å¾¡ã—ã¾ã™ã€‚
2.  **`NOT`**: æ¡ä»¶ã‚’å¦å®šã—ã¾ã™ã€‚
3.  **`AND`**: æ¡ä»¶ã‚’è«–ç†ç©ã§çµåˆã—ã¾ã™ã€‚
4.  **`OR`**: æ¡ä»¶ã‚’è«–ç†å’Œã§çµåˆã—ã¾ã™ã€‚

`AND` ã¨ `OR` ã¯å·¦çµåˆã§ã™ã€‚ã¤ã¾ã‚Šã€`A OR B OR C` ã¯ `(A OR B) OR C` ã¨ã—ã¦è©•ä¾¡ã•ã‚Œã¾ã™ã€‚

### **10.3 å…·ä½“ä¾‹**
#### **AND: æ¡ä»¶ã®çµ„ã¿åˆã‚ã›**
**DSL**: `ingredients.name:"ã‚¸ãƒ³" AND alcohol_content:>20`  
**æ„å‘³**: ææ–™ã«ã€Œã‚¸ãƒ³ã€ã‚’å«ã¿ã€ã‹ã¤ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°ãŒ20ã‚’è¶…ãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

#### **OR: æ¡ä»¶ã®é¸æŠ**
**DSL**: `author.name="Bar Curion" OR author.name="Guest"`  
**æ„å‘³**: ä½œè€…ãŒ "Bar Curion" ã§ã‚ã‚‹ã‹ã€ã¾ãŸã¯ "Guest" ã§ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

#### **NOT: æ¡ä»¶ã®å¦å®š**
**DSL**: `NOT ingredients.name:"ç ‚ç³–"`  
**æ„å‘³**: ææ–™ã«ã€Œç ‚ç³–ã€ã‚’ä¸€åˆ‡å«ã¾ãªã„ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã“ã‚Œã¯ `none(ingredients, name:"ç ‚ç³–")` ã¨ç­‰ä¾¡ã§ã™ã€‚

#### **æ‹¬å¼§ã«ã‚ˆã‚‹ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°**
**DSL**: `(name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹" OR name:"ãƒãƒ³ãƒãƒƒã‚¿ãƒ³") AND alcohol_content:>30`  
**æ„å‘³**: åå‰ãŒã€Œãƒãƒ†ã‚£ãƒ¼ãƒ‹ã€ã¾ãŸã¯ã€Œãƒãƒ³ãƒãƒƒã‚¿ãƒ³ã€ã®ã„ãšã‚Œã‹ã§ã‚ã‚Šã€ã‹ã¤ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«åº¦æ•°ãŒ30ã‚’è¶…ãˆã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã¾ã™ã€‚æ‹¬å¼§ãŒãªã„å ´åˆã€`AND`ãŒå„ªå…ˆã•ã‚Œã¦æ„å›³ã—ãªã„çµæœã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### **10.4 NOTã¨é‡åŒ–å­ã®é–¢ä¿‚**
`NOT` æ¼”ç®—å­ã¯ã€é…åˆ—é‡åŒ–å­ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€æ„å‘³çš„ã«ç­‰ä¾¡ãªåˆ¥ã®é‡åŒ–å­ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚ã“ã®å¤‰æ›ã¯æ­£è¦åŒ–ã®éç¨‹ã§è‡ªå‹•çš„ã«è¡Œã‚ã‚Œã¾ã™ï¼ˆ**ç¬¬11ç« **å‚ç…§ï¼‰ã€‚
- `NOT any(P, X)` ã¯ `none(P, X)` ã¨ç­‰ä¾¡ã§ã™ã€‚
- `NOT all(P, X)` ã¯ `any(P, NOT X)` ã¨ç­‰ä¾¡ã§ã™ï¼ˆã€Œã™ã¹ã¦ãŒXã§ã‚ã‚‹ã€ã®å¦å®šã¯ã€ŒXã§ãªã„ã‚‚ã®ãŒä¸€ã¤ã§ã‚‚ã‚ã‚‹ã€ï¼‰ã€‚
- `NOT none(P, X)` ã¯ `any(P, X)` ã¨ç­‰ä¾¡ã§ã™ï¼ˆã€ŒXã§ã‚ã‚‹ã‚‚ã®ãŒä¸€ã¤ã‚‚ãªã„ã€ã®å¦å®šã¯ã€ŒXã§ã‚ã‚‹ã‚‚ã®ãŒä¸€ã¤ã§ã‚‚ã‚ã‚‹ã€ï¼‰ã€‚

### **10.5 ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¨æ³¨æ„ç‚¹**
- **æ¼”ç®—å­ã®é€£ç¶š**: `A AND AND B` ã®ã‚ˆã†ãªã€äºŒé …æ¼”ç®—å­ã®é€£ç¶šã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚
- **ä¸å®Œå…¨ãªå¼**: `AND A` ã‚„ `A OR` ã®ã‚ˆã†ã«ã€æ¼”ç®—å­ã®ç‰‡å´ãŒæ¬ ã‘ã¦ã„ã‚‹å¼ã¯æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚
- **å¤šé‡å¦å®š**: `NOT NOT A` ã¯ `A` ã¨ç­‰ä¾¡ã§ã‚ã‚Šã€æ­£è¦åŒ–æ®µéšã§ç°¡ç´„ã•ã‚Œã¾ã™ã€‚

***

## **ç¬¬11ç«  æ­£è¦åŒ–è¦å‰‡ï¼ˆASTã‹ã‚‰CIRã¸ï¼‰**

> **æ³¨æ„**: ã“ã®ç« ã¯ã€DSLãƒ‘ãƒ¼ã‚µãƒ¼ã‚„ã‚¢ãƒ€ãƒ—ã‚¿ã®å®Ÿè£…è€…å‘ã‘ã®æŠ€è¡“çš„ãªè©³ç´°ã‚’è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚DSLã®åˆ©ç”¨è€…ã®æ–¹ã¯ã€ã“ã®ç« ã‚’èª­ã¿é£›ã°ã—ã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

### **11.1 ç›®çš„**
ãƒ‘ãƒ¼ã‚¹ç›´å¾Œã®ASTï¼ˆæŠ½è±¡æ§‹æ–‡æœ¨ï¼‰ã«ã¯ã€çœç•¥å½¢ã‚„å¤šæ§˜ãªå¦å®šã®è¡¨ç¾ãªã©ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ãã®ã¾ã¾ã§ã¯æ‰±ã„ã«ãã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§ã€ASTã‚’è©•ä¾¡ã‚„ã‚¢ãƒ€ãƒ—ã‚¿å¤‰æ›ã«é©ã—ãŸä¸€è²«æ€§ã®ã‚ã‚‹ä¸­é–“è¡¨ç¾ï¼ˆCIR: Canonical Intermediate Representationï¼‰ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã®å¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€Œæ­£è¦åŒ–ã€ã¨å‘¼ã³ã¾ã™ã€‚

### **11.2 æ­£è¦åŒ–ã®ä¸»è¦ãªãƒ«ãƒ¼ãƒ«**
#### **ãƒ«ãƒ¼ãƒ«A: çœç•¥å½¢ã®å±•é–‹**
- ãƒ†ã‚­ã‚¹ãƒˆçœç•¥å½¢ã¯ã€`text` æ¼”ç®—ã«å±•é–‹ã—ã¾ã™ã€‚
  - `path:"text"` â†’ `text(contains, path, "text")`
- ã‚³ãƒ­ãƒ³ä»˜ãæ¯”è¼ƒæ¼”ç®—ã¯ã€`cmp` æ¼”ç®—ã«å±•é–‹ã—ã¾ã™ã€‚
  - `path:>10` â†’ `cmp(gt, path, 10)`
- é…åˆ—ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã¯ã€`quantified` æ¼”ç®—ã«æ˜ç¤ºçš„ã«å±•é–‹ã—ã¾ã™ã€‚
  - `ingredients.name:"ã‚¸ãƒ³"` â†’ `quantified(any, ingredients, text(contains, name, "ã‚¸ãƒ³"))`

#### **ãƒ«ãƒ¼ãƒ«B: NOTã®æŠ¼ã—ä¸‹ã’ï¼ˆå¦å®šæ­£è¦å½¢ï¼‰**
`NOT` æ¼”ç®—å­ã‚’å¯èƒ½ãªé™ã‚Šãƒ„ãƒªãƒ¼ã®æœ«ç«¯ã«ç§»å‹•ã•ã›ã€è©•ä¾¡ã‚’å˜ç´”åŒ–ã—ã¾ã™ã€‚
- **ãƒ‰ãƒ»ãƒ¢ãƒ«ã‚¬ãƒ³ã®æ³•å‰‡ã®é©ç”¨**:
  - `NOT (A AND B)` â†’ `(NOT A) OR (NOT B)`
  - `NOT (A OR B)` â†’ `(NOT A) AND (NOT B)`
- **é‡åŒ–å­ã®å¤‰æ›**:
  - `NOT any(P, X)` â†’ `none(P, X)`
  - `NOT all(P, X)` â†’ `any(P, NOT X)`

#### **ãƒ«ãƒ¼ãƒ«C: è¤‡åˆå€¤ãƒªã‚¹ãƒˆã®å±•é–‹**
- æ–‡å­—åˆ—ãƒªã‚¹ãƒˆã¯ `OR` ã«å±•é–‹ã—ã¾ã™ã€‚
  - `path:("A", "B")` â†’ `or(text(contains, path, "A"), text(contains, path, "B"))`
- æ•°å€¤æ¯”è¼ƒãƒªã‚¹ãƒˆã¯ `AND` ã«å±•é–‹ã—ã¾ã™ã€‚
  - `path:(>5, <13)` â†’ `and(cmp(gt, path, 5), cmp(lt, path, 13))`

#### **ãƒ«ãƒ¼ãƒ«D: é…åˆ—å¢ƒç•Œã®æ˜ç¤º**
- **åŒä¸€è¦ç´ å†…AND**: `ingredients:(name:"ã‚¸ãƒ³" AND type:"ã‚¹ãƒ”ãƒªãƒƒãƒ„")`
  - â†’ `quantified(any, ingredients, and(text(contains, name, "ã‚¸ãƒ³"), cmp(eq, type, "ã‚¹ãƒ”ãƒªãƒƒãƒ„")))`
- **è¦ç´ æ¨ªæ–­AND**: `ingredients.name:("ã‚¸ãƒ³" AND "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`
  - â†’ `and(quantified(any, ingredients, text(contains, name, "ã‚¸ãƒ³")), quantified(any, ingredients, text(contains, name, "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")))`

#### **ãƒ«ãƒ¼ãƒ«E: æ§‹é€ ã®å¹³å¦åŒ–**
- AND/OR ã®ãƒã‚¹ãƒˆã¯å¯èƒ½ãªé™ã‚Šå¹³å¦åŒ–ã•ã‚Œã¾ã™ï¼ˆä¾‹: ``And(And(A,B),C)` â†’ `And(A,B,C)ï¼‰ã€‚

#### **ãƒ«ãƒ¼ãƒ«F: Truthyãªå¼ã®æ­£è¦åŒ–ï¼ˆè£œè¶³ï¼‰**
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ‘ã‚¹å˜ä½“ã¯å­˜åœ¨åˆ¤å®šã¸æ­£è¦åŒ–ã•ã‚Œã¾ã™ï¼ˆä¾‹`: path` â†’ `path != null`ï¼‰ã€‚
- ãƒªãƒ†ãƒ©ãƒ«å˜ä½“ï¼ˆ`"text"`, `0`, `true`, `null` ãªã©ï¼‰ã® `truthy`/`falsy` ã¯ç¾çŠ¶æœªå®šç¾©ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰ã§ã™ã€‚


ã“ã®æ­£è¦åŒ–ã«ã‚ˆã‚Šã€å¾Œæ®µã®è©•ä¾¡å™¨ã‚„å„ç¨®DBã‚¢ãƒ€ãƒ—ã‚¿ã¯ã€ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ä¸€è²«æ€§ã®ã‚ã‚‹CIRã‚’å‰æã¨ã—ã¦å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

***

## **ç¬¬12ç«  ã‚¨ãƒ©ãƒ¼ä»•æ§˜ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–¹é‡ãƒ»ä»£è¡¨ã‚±ãƒ¼ã‚¹ï¼‰**

ã“ã®ç« ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç„¡åŠ¹ãªã‚¯ã‚¨ãƒªã‚’å…¥åŠ›ã—ãŸéš›ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ–¹é‡ã¨ã€ä»£è¡¨çš„ãªã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### **12.1 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åŸºæœ¬æ–¹é‡**
é–‹ç™ºè€…ãŒã‚¯ã‚¨ãƒªã‚’å®¹æ˜“ã«ä¿®æ­£ã§ãã‚‹ã‚ˆã†ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®è¦ç´ ã‚’å«ã‚€ã“ã¨ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚
- **ä½ç½®æƒ…å ±**: ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸè¡Œãƒ»åˆ—ç•ªå·ã€‚
- **ã‚¨ãƒ©ãƒ¼å†…å®¹**: ä½•ãŒå•é¡Œã§ã‚ã‚‹ã‹ã®ç°¡æ½”ãªèª¬æ˜ï¼ˆä¾‹: `é–‰ã˜æ‹¬å¼§ ')' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`ï¼‰ã€‚
- **ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**: ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã®å‘¨è¾ºã‚³ãƒ¼ãƒ‰ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã€‚
- **ä¿®æ­£ææ¡ˆ**: å¯èƒ½ã§ã‚ã‚Œã°ã€æ­£ã—ã„æ§‹æ–‡ã®ä¾‹ã‚’æç¤ºï¼ˆä¾‹: `äºˆç´„èªã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¨ã—ã¦ä½¿ç”¨ã™ã‚‹å ´åˆã¯ "AND" ã®ã‚ˆã†ã«ã‚¯ã‚ªãƒ¼ãƒˆã§å›²ã£ã¦ãã ã•ã„`ï¼‰ã€‚

### **12.2 ä»£è¡¨çš„ãªæ§‹æ–‡ã‚¨ãƒ©ãƒ¼**
- **æ‹¬å¼§ã®ä¸æ•´åˆ**: `(name:"A" OR name:"B"`
  - â†’ `ã‚¨ãƒ©ãƒ¼: é–‰ã˜æ‹¬å¼§ ')' ãŒå¿…è¦ã§ã™ã€‚`
- **æ¼”ç®—å­ã®é€£ç¶š**: `A AND AND B`
  - â†’ `ã‚¨ãƒ©ãƒ¼: æ¼”ç®—å­ 'AND' ã®å¾Œã«äºˆæœŸã—ãªã„ãƒˆãƒ¼ã‚¯ãƒ³ 'AND' ãŒã‚ã‚Šã¾ã™ã€‚å¼ãŒå¿…è¦ã§ã™ã€‚`
- **ä¸å®Œå…¨ãªå¼**: `A OR`
  - â†’ `ã‚¨ãƒ©ãƒ¼: ã‚¯ã‚¨ãƒªã®æœ«å°¾ã«äºˆæœŸã—ãªã„æ¼”ç®—å­ 'OR' ãŒã‚ã‚Šã¾ã™ã€‚`
- **ç©ºã®å€¤ãƒªã‚¹ãƒˆ**: `path:()`
  - â†’ `ã‚¨ãƒ©ãƒ¼: å€¤ãƒªã‚¹ãƒˆ '()' ã‚’ç©ºã«ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚`
- **å€¤ã®ãªã„æ¯”è¼ƒ**: `price:>`
  - â†’ `ã‚¨ãƒ©ãƒ¼: æ¯”è¼ƒæ¼”ç®—å­ '>' ã®å¾Œã«å€¤ãŒå¿…è¦ã§ã™ã€‚`

### **12.3 å‹ãƒ»çµ„ã¿åˆã‚ã›ã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼**
- **å€¤ãƒªã‚¹ãƒˆå†…ã®å‹æ··åœ¨**: `path:("A", >5)`
  - â†’ `ã‚¨ãƒ©ãƒ¼: å€¤ãƒªã‚¹ãƒˆå†…ã§å‹ã‚’æ··åœ¨ã•ã›ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼ˆæ–‡å­—åˆ—ã¨æ•°å€¤æ¯”è¼ƒï¼‰ã€‚`
- **äºˆç´„èªã®èª¤ç”¨**: `AND.name:"x"`
  - â†’ `ã‚¨ãƒ©ãƒ¼: äºˆç´„èª 'AND' ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¨ã—ã¦ç›´æ¥ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã« '"AND"' ã®ã‚ˆã†ã«ã‚¯ã‚ªãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚`
- **éå¯¾å¿œã®æ¼”ç®—**: `price:contains("100")`
  - â†’ `ã‚¨ãƒ©ãƒ¼: æ•°å€¤å‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®— 'contains' ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚`

### **12.4 ã‚¬ã‚¤ãƒ‰ä»˜ãã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**
ä¸€éƒ¨ã®æ›–æ˜§ãªæ§‹æ–‡ã«ã¤ã„ã¦ã¯ã€ã‚ˆã‚Šè¦ªåˆ‡ãªã‚¬ã‚¤ãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚
- **ä¾‹**: `ingredients.name:("ã‚¸ãƒ³" AND "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`
  - â†’ `è­¦å‘Š: ã“ã®æ§‹æ–‡ã¯ã€åˆ¥ã€…ã®ææ–™ã§æ¡ä»¶ãŒæº€ãŸã•ã‚Œã¦ã‚‚ãƒãƒƒãƒã—ã¾ã™ã€‚ã‚‚ã—ã€ŒåŒä¸€ã®ææ–™ã€ãŒä¸¡æ–¹ã®æ¡ä»¶ã‚’æº€ãŸã™ã“ã¨ã‚’æ„å›³ã—ã¦ã„ã‚‹å ´åˆã¯ã€'ingredients:(name:"ã‚¸ãƒ³" AND name:"ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")' ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚`

é©åˆ‡ãªã‚¨ãƒ©ãƒ¼å ±å‘Šã¯ã€DSLã®ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã‚’å¤§ããå‘ä¸Šã•ã›ã‚‹é‡è¦ãªè¦ç´ ã§ã™ã€‚

***

## **ç¬¬13ç«  ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨å°†æ¥æ‹¡å¼µ**

ã“ã®ç« ã§ã¯ã€v0.1ã§å°å…¥å¯èƒ½ãªå®Ÿè£…ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã€v0.2ä»¥é™ã§æ¤œè¨ã•ã‚Œã‚‹æ‹¡å¼µé …ç›®ã«ã¤ã„ã¦æ•´ç†ã—ã¾ã™ã€‚

### **13.1 å®Ÿè£…ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆv0.1ï¼‰**
ãƒ‘ãƒ¼ã‚µãƒ¼ã‚„è©•ä¾¡å™¨ã«æ¸¡ã™ã“ã¨ã§ã€æŒ™å‹•ã‚’èª¿æ•´ã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
- **`ignoreCase` (boolean)**
  - **å½¹å‰²**: `true`ã«è¨­å®šã™ã‚‹ã¨ã€æ–‡å­—åˆ—æ¯”è¼ƒï¼ˆ`=`ï¼‰ãŠã‚ˆã³ãƒ†ã‚­ã‚¹ãƒˆæ¼”ç®—ï¼ˆ`contains`ç­‰ï¼‰ã§å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªããªã‚Šã¾ã™ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `false`ï¼ˆåŒºåˆ¥ã™ã‚‹ï¼‰
  - **è£œè¶³**: `ignoreCase=true` ã®å ´åˆã¯ `toLocaleLowerCase(locale)` ã‚’é©ç”¨ã™ã‚‹ã€‚`toLocaleLowerCase(locale)` ã¯ãƒ­ã‚±ãƒ¼ãƒ«ä¾å­˜ã®å¤‰æ›ã‚’è¡Œã†ã€‚`en-US` ã§ã¯ â€œIâ€â†’â€œiâ€ã€`tr`(ãƒˆãƒ«ã‚³) ã§ã¯ â€œIâ€â†’â€œÄ±â€ã€‚

- **`locale` (string)**
  - **å½¹å‰²**: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨€èªã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚
  - **æŒ‡å®š**: `"ja"`, `"en"` ãªã©ã€‚
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `"ja"`

- **`foldDiacritics` (boolean)**
  - **å½¹å‰²**: ã‚¢ã‚¯ã‚»ãƒ³ãƒˆè¨˜å·ã®å·®ã‚’å¸åã™ã‚‹ãŸã‚ã€NFD æ­£è¦åŒ–å¾Œã« U+0300â€“U+036F ã‚’é™¤å»ã™ã‚‹ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `false`ã€‚
  - **åˆ¶é™**: åˆæˆæ¸ˆã¿æ–‡å­—ãŒ NFD ã§åŸºåº•æ–‡å­—ï¼‹çµåˆè¨˜å·ã«åˆ†è§£ã•ã‚ŒãŸå ´åˆã€åŸºåº•æ–‡å­—ã®ã¿ãŒæ®‹ã‚‹ã€‚ä¾‹: â€œÄ°â€ï¼ˆU+0130ï¼‰ã¯ NFD å¾Œ â€œIâ€ + U+0307 ã«åˆ†è§£ã•ã‚Œã€é™¤å»ã«ã‚ˆã‚Š â€œIâ€ ã¨ãªã‚‹ï¼ˆâ€œiâ€ ã«ã¯ãªã‚‰ãªã„ï¼‰ã€‚

### **13.2 å°†æ¥æ‹¡å¼µï¼ˆv0.2ä»¥é™ã®å€™è£œï¼‰**
- **`in` / `not in` æ¼”ç®—å­**:
  - `field in ("A", "B", "C")` ã®ã‚ˆã†ãªSQLãƒ©ã‚¤ã‚¯ãªæ§‹æ–‡ã€‚æ—¢å­˜ã® `field:("A", "B", "C")` ã®ç³–è¡£æ§‹æ–‡ï¼ˆã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚·ãƒ¥ã‚¬ãƒ¼ï¼‰ã¨ã—ã¦å°å…¥ã‚’æ¤œè¨ã—ã¾ã™ã€‚
- **æ­£è¦è¡¨ç¾ãƒãƒƒãƒ**:
  - `name ~ /^ãƒ‰ãƒ©ã‚¤/` ã®ã‚ˆã†ãªæ¼”ç®—å­ã‚’å°å…¥ã€‚ReDoSï¼ˆæ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹ã‚µãƒ¼ãƒ“ã‚¹æ‹’å¦ï¼‰æ”»æ’ƒã¸ã®å¯¾ç­–ã‚’è¬›ã˜ãŸä¸Šã§ã®é™å®šçš„ãªæä¾›ã‚’æ¤œè¨ã—ã¾ã™ã€‚
- **æ—¥ä»˜/æ™‚åˆ»å‹ã®ã‚µãƒãƒ¼ãƒˆ**:
  - `created_at >= "2025-01-01T00:00:00Z"` ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã‚’ã€ISO 8601å½¢å¼ã®æ–‡å­—åˆ—ã‚’æ—¥ä»˜ã¨ã—ã¦è§£é‡ˆã—ã¦æ¯”è¼ƒã™ã‚‹æ©Ÿèƒ½ã€‚
- **ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰**:
  - `name:"ãƒ‰ãƒ©ã‚¤*"` ã‚’ `startsWith(name, "ãƒ‰ãƒ©ã‚¤")` ã¨è§£é‡ˆã™ã‚‹ã‚ˆã†ãªã€ã‚ˆã‚Šç›´æ„Ÿçš„ãªçœç•¥å½¢ã€‚
- **ã‚¹ã‚­ãƒ¼ãƒé€£æº**:
  - JSON Schemaãªã©ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€ãƒ‘ãƒ¼ã‚µãƒ¼ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ï¼ˆæ•°å€¤ã‹æ–‡å­—åˆ—ã‹ãªã©ï¼‰ã‚’äº‹å‰ã«èªè­˜ã—ã€ã‚ˆã‚Šå³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯ã‚„è£œå®Œã‚’è¡Œã†æ©Ÿèƒ½ã€‚
- **å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¤œç´¢ã®ç³–è¡£æ§‹æ–‡**: `contains("text")` ã‚’æ—¢å®šã®ãƒ†ã‚­ã‚¹ãƒˆå¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ç¾¤ã« OR å±•é–‹ã™ã‚‹æ©Ÿèƒ½ã‚’æ¤œè¨ä¸­ã§ã™ï¼ˆå¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯è¨­å®š/ã‚¹ã‚­ãƒ¼ãƒã§ç®¡ç†ã™ã‚‹æ–¹é‡ï¼‰ã€‚


### **13.3 äº’æ›æ€§æ–¹é‡**
- **å¾Œæ–¹äº’æ›æ€§ã®ç¶­æŒ**: æ–°æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹éš›ã€æ—¢å­˜ã®ã‚¯ã‚¨ãƒªã®è§£é‡ˆãŒå¤‰ã‚ã‚‰ãªã„ã‚ˆã†ã«æœ€å¤§é™é…æ…®ã—ã¾ã™ã€‚ç ´å£Šçš„å¤‰æ›´ã¯ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—æ™‚ã«ã®ã¿è¡Œã„ã¾ã™ã€‚
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã®å®‰å®š**: `ignoreCase` ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãªã©ã€åŸºæœ¬çš„ãªæŒ™å‹•ã¯å°†æ¥ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚‚ç¶­æŒã—ã¾ã™ã€‚

***

## **ç¬¬14ç«  äº’æ›ãƒ»éç›®æ¨™ï¼ˆæœ¬DSLãŒã‚«ãƒãƒ¼ã—ãªã„ã‚‚ã®ï¼‰**

ã“ã®ç« ã§ã¯ã€æœ¬DSLãŒæ„å›³çš„ã«ã‚«ãƒãƒ¼ã—ãªã„ç¯„å›²ï¼ˆéç›®æ¨™ï¼‰ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ã§ã€åˆ©ç”¨è€…ãŒæŠ€è¡“é¸å®šã‚’è¡Œã†éš›ã®åˆ¤æ–­ææ–™ã‚’æä¾›ã—ã¾ã™ã€‚

### **14.1 éç›®æ¨™ï¼ˆv0.1ã§ã‚«ãƒãƒ¼ã—ãªã„é ˜åŸŸï¼‰**
- **ãƒ•ãƒ«ã‚¹ãƒšãƒƒã‚¯ã®å…¨æ–‡æ¤œç´¢**:
  - è¤‡é›‘ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€å½¢æ…‹ç´ è§£æãªã©ã¯å¯¾è±¡å¤–ã§ã™ã€‚æœ¬DSLã¯ã€ä¸»ã«æ§‹é€ åŒ–ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹ãƒ–ãƒ¼ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆæ¡ä»¶ã«åˆè‡´ã™ã‚‹ã‹å¦ã‹ï¼‰ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚
- **SQLã®`JOIN`ã‚„ã‚µãƒ–ã‚¯ã‚¨ãƒªã«ç›¸å½“ã™ã‚‹æ©Ÿèƒ½**:
  - è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ã¾ãŸãŒã‚‹ã‚ˆã†ãªè¤‡é›‘ãªçµåˆæ“ä½œã¯ã‚µãƒãƒ¼ãƒˆã—ã¾ã›ã‚“ã€‚ãã®ã‚ˆã†ãªå‡¦ç†ã¯ã€æœ¬DSLãŒé©ç”¨ã•ã‚Œã‚‹å‰æ®µã®ãƒ‡ãƒ¼ã‚¿æº–å‚™å±¤ã€ã¾ãŸã¯å¾Œæ®µã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®è²¬å‹™ã¨ã—ã¾ã™ã€‚
- **é«˜åº¦ãªå‹æ¨è«–**:
  - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‹ã‚‰å‹ã‚’å‹•çš„ã«æ¨è«–ã™ã‚‹æ©Ÿèƒ½ã¯æŒã¡ã¾ã›ã‚“ã€‚æ¯”è¼ƒã‚„æ¼”ç®—ã¯ã€å–å¾—ã—ãŸå€¤ã®å‹ã«ä¾å­˜ã—ã¦å®Ÿè¡Œæ™‚ã«è©•ä¾¡ã•ã‚Œã¾ã™ã€‚
- **è¨€èªä¾å­˜ã®æ–‡å­—åˆ—ç…§åˆï¼ˆCollationï¼‰**:
  - å…¨è§’/åŠè§’ã®åŒºåˆ¥ã€æ¿ç‚¹/åŠæ¿ç‚¹ã®æœ‰ç„¡ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ãªã€æ—¥æœ¬èªç‰¹æœ‰ã®é«˜åº¦ãªæ–‡å­—åˆ—æ¯”è¼ƒã¯ã‚µãƒãƒ¼ãƒˆã—ã¾ã›ã‚“ã€‚
- **è¨€èªã”ã¨ã®é«˜åº¦ãªã‚±ãƒ¼ã‚¹ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ³ã‚°/ç…§åˆï¼ˆå®Œå…¨ãª Collationï¼‰ã¯å¯¾è±¡å¤–**:  
  - `Evaluator` ã¯ `foldDiacritics` ã¨ `ignoreCase` ã®ç¯„å›²ã§è»½é‡ãªæ•´å½¢ã®ã¿ã‚’è¡Œã†ï¼ˆlocale=tr ã§ã® â€œÄ°â€â†’â€œÄ±â€ å•é¡Œã¯ãƒ­ã‚±ãƒ¼ãƒ«ä¾å­˜ã®å°æ–‡å­—åŒ–ã«å§”ã­ã€å®Œå…¨ãªæ„å‘³è«–çš„ç­‰ä¾¡ã¯ä¿è¨¼ã—ãªã„ï¼‰ã€‚


### **14.2 ä»–ã®ä»•æ§˜ã¨ã®é–¢ä¿‚**
- **JMESPath, RSQL/FIQLç­‰**: ã“ã‚Œã‚‰ã®æ—¢å­˜ä»•æ§˜ã¨ã®ç›´æ¥çš„ãªäº’æ›æ€§ã¯ç›®æ¨™ã¨ã—ã¾ã›ã‚“ã€‚æœ¬DSLã¯ã€ã‚ˆã‚Šç›´æ„Ÿçš„ã§å­¦ç¿’ã‚³ã‚¹ãƒˆã®ä½ã„æ§‹æ–‡ã‚’æä¾›ã™ã‚‹ã“ã¨ã«é‡ç‚¹ã‚’ç½®ã„ã¦ã„ã¾ã™ã€‚
- **å„ç¨®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®å¤‰æ›**: æœ¬DSLã‹ã‚‰MongoDBã‚¯ã‚¨ãƒªã‚„SQLã®`WHERE`å¥ã¸ã®å¤‰æ›ã¯ã€ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ãªãã€ç‹¬ç«‹ã—ãŸã€Œã‚¢ãƒ€ãƒ—ã‚¿ã€ã¨ã—ã¦æä¾›ã•ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ã‚¢ä»•æ§˜ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã«ä¿ã¡ã¾ã™ã€‚

### **14.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹è²¬å‹™**
- **ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™**: ã‚¯ã‚¨ãƒªã®å®Ÿè¡Œæ™‚é–“ä¸Šé™ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰ã‚„ã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®åˆ¶é™ã¯ã€æœ¬DSLã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‘¼ã³å‡ºã™å®Ÿè¡Œç’°å¢ƒå´ã®è²¬å‹™ã¨ã—ã¾ã™ã€‚
- **ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–**: å„ç¨®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ãƒ€ãƒ—ã‚¿ã¯ã€ç”Ÿæˆã™ã‚‹ã‚¯ã‚¨ãƒªãŒå®‰å…¨ã§ã‚ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆä¾‹: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨ï¼‰ã€‚

***

## **ç¬¬15ç«  å‚è€ƒã®å†™åƒä¾‹ï¼ˆDSLã‹ã‚‰CIRã¸ã®å¤‰æ›ã‚¹ã‚±ãƒƒãƒï¼‰**

> **æ³¨æ„**: ã“ã®ç« ã¯ã€å®Ÿè£…è€…å‘ã‘ã®å‚è€ƒæƒ…å ±ã§ã™ã€‚DSLãŒå†…éƒ¨çš„ã«ã©ã®ã‚ˆã†ã«æ­£è¦åŒ–ã•ã‚Œã‚‹ã‹ã®å…·ä½“ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

### **15.1 ç›®çš„**
ä»£è¡¨çš„ãªDSLã‚¯ã‚¨ãƒªãŒã€æ­£è¦åŒ–ã•ã‚ŒãŸä¸­é–“è¡¨ç¾ï¼ˆCIRï¼‰ã«ã©ã®ã‚ˆã†ã«å¤‰æ›ã•ã‚Œã‚‹ã‹ã‚’ç¤ºã™ã“ã¨ã§ã€ã‚¢ãƒ€ãƒ—ã‚¿é–‹ç™ºãªã©ã®å‚è€ƒã«è³‡ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚

### **15.2 ä¾‹1ï¼šé…åˆ—ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ï¼‹æ•°å€¤æ¯”è¼ƒ**
**DSL**: `ingredients.name:"ã‚¸ãƒ³" AND alcohol_content:>20`  
**CIRã‚¹ã‚±ãƒƒãƒ**:
```json
{
  "type": "and",
  "children": [
    {
      "type": "quantified", "quantifier": "any", "path": ["ingredients"],
      "inner": { "type": "text", "op": "contains", "path": ["name"], "value": "ã‚¸ãƒ³" }
    },
    { "type": "cmp", "op": "gt", "path": ["alcohol_content"], "value": 20 }
  ]
}
```

### **15.3 ä¾‹2ï¼šåŒä¸€è¦ç´ å†…AND**
**DSL**: `ingredients:(name:"ã‚¸ãƒ³" AND type:"ã‚¹ãƒ”ãƒªãƒƒãƒ„")`  
**CIRã‚¹ã‚±ãƒƒãƒ**:
```json
{
  "type": "quantified", "quantifier": "any", "path": ["ingredients"],
  "inner": {
    "type": "and",
    "children": [
      { "type": "text", "op": "contains", "path": ["name"], "value": "ã‚¸ãƒ³" },
      { "type": "cmp", "op": "eq", "path": ["type"], "value": "ã‚¹ãƒ”ãƒªãƒƒãƒ„" }
    ]
  }
}
```

### **15.4 ä¾‹3ï¼šè¤‡æ•°å€¤ã®OR**
**DSL**: `ingredients.name:("ã‚¸ãƒ³","ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼")`  
**CIRã‚¹ã‚±ãƒƒãƒ**:
```json
{
  "type": "quantified", "quantifier": "any", "path": ["ingredients"],
  "inner": {
    "type": "or",
    "children": [
      { "type": "text", "op": "contains", "path": ["name"], "value": "ã‚¸ãƒ³" },
      { "type": "text", "op": "contains", "path": ["name"], "value": "ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼" }
    ]
  }
}
```

### **15.5 ä¾‹4ï¼šNOTã®æŠ¼ã—ä¸‹ã’**
**DSL**: `NOT (name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹" OR alcohol_content < 10)`  
**CIRã‚¹ã‚±ãƒƒãƒ (æ­£è¦åŒ–å¾Œ)**:
```json
{
  "type": "and",
  "children": [
    { "type": "not", "child": { "type": "text", "op": "contains", "path": ["name"], "value": "ãƒãƒ†ã‚£ãƒ¼ãƒ‹" } },
    { "type": "cmp", "op": "gte", "path": ["alcohol_content"], "value": 10 }
  ]
}
```
> **è§£èª¬**: `NOT`ãŒåˆ†é…ã•ã‚Œã€`OR`ã¯`AND`ã«ã€`<`ã¯`>=`ã«åè»¢ã—ã¦ã„ã¾ã™ã€‚